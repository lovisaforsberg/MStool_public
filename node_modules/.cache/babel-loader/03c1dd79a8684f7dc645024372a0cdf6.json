{"ast":null,"code":"var _jsxFileName = \"/Users/lovisaforsberg/MS_vis/ms_viz/src/components/barchart.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useRef, useReducer, useState, createContext } from \"react\";\nimport * as d3 from 'd3';\nimport '../../node_modules/@ibm/plex/css/ibm-plex.css';\nimport '../style/barchart.css';\nimport testData from '../data/sveaskog.csv';\nimport { SentimentContext } from '../App';\nimport { HoverSentContext } from './graphContainer';\nimport { HoverContext } from \"../App\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst BarChart = () => {\n  _s();\n\n  const SentSentimentContext = useContext(SentimentContext);\n  const {\n    choosenSentiment,\n    setChoosenSentiment\n  } = SentSentimentContext;\n  const SentHoverSentContext = useContext(HoverSentContext);\n  const {\n    hoverSent,\n    setHoverSent\n  } = SentHoverSentContext;\n  const SentHoverContext = useContext(HoverContext);\n  const {\n    hover,\n    setHover\n  } = SentHoverContext;\n  const d3Container = useRef(null);\n  var post_data = [];\n  var keys = [];\n  var sent = [];\n  var eng = [];\n  var stack_key_mapping = {\n    \"Positive\": \"Sentiment\",\n    \"Negative\": \"Sentiment\",\n    \"Neutral\": \"Sentiment\",\n    \"Comments\": \"Engagement\",\n    \"Likes\": \"Engagement\",\n    \"Shares\": \"Engagement\"\n  };\n\n  const getPosts = data => {\n    if (!('children' in data)) {\n      keys.push(data.name);\n      sent.push(data.pos);\n      eng.push(data.comments);\n      post_data.push({\n        postname: data.name,\n        values: [//{name: 'Engagement', com:data.comments, like: data.likes, share: data.shares, post:data.name},\n        //{name: 'Sentiment', pos:data.pos, neg:data.neg, neu:data.neu, post:data.name}\n        {\n          name: 'Positive',\n          value: data.pos,\n          yoffset: data.pos,\n          yscale: 1,\n          total: data.pos + data.neg + data.neu,\n          postName: data.name\n        }, {\n          name: 'Negative',\n          value: data.neg,\n          yoffset: data.neg + data.pos,\n          yscale: 1,\n          total: data.pos + data.neg + data.neu,\n          postName: data.name\n        }, {\n          name: 'Neutral',\n          value: data.neu,\n          yoffset: data.pos + data.neg + data.neu,\n          yscale: 1,\n          total: data.pos + data.neg + data.neu,\n          postName: data.name\n        }, {\n          name: 'Comments',\n          value: data.comments / data.followers * 100,\n          yoffset: data.comments / data.followers * 100,\n          yscale: 0,\n          total: (data.comments + data.likes + data.shares) / data.followers * 100,\n          postName: data.name,\n          followers: data.followers\n        }, {\n          name: 'Likes',\n          value: data.likes / data.followers * 100,\n          yoffset: (data.comments + data.likes) / data.followers * 100,\n          yscale: 0,\n          total: (data.comments + data.likes + data.shares) / data.followers * 100,\n          postName: data.name,\n          followers: data.followers\n        }, {\n          name: 'Shares',\n          value: data.shares / data.followers * 100,\n          yoffset: (data.comments + data.likes + data.shares) / data.followers * 100,\n          yscale: 0,\n          total: (data.comments + data.likes + data.shares) / data.followers * 100,\n          postName: data.name,\n          followers: data.followers\n        }]\n      });\n    } else {\n      data.children.forEach(child => {\n        getPosts(child);\n      });\n    }\n  };\n\n  const handleHover = type => {\n    if (type === 'Likes' || type === 'Comments' || type === 'Shares') {\n      setHoverSent('eng');\n    } else {\n      setHoverSent(type);\n    }\n  };\n\n  getPosts(choosenSentiment);\n  useEffect(() => {\n    d3.select(\".root_barchart\").selectAll('*').remove();\n    d3.select(\".legend\").selectAll('*').remove();\n    var margin = {\n      top: 20,\n      right: 40,\n      bottom: 30,\n      left: 40\n    },\n        width = 500 - margin.left - margin.right,\n        height = 250 - margin.top - margin.bottom;\n    var divTooltip = d3.select('body').append('div').attr('class', 'toolTip').attr('font-size', '100px');\n    var x0 = d3.scaleBand().domain(keys).rangeRound([0, width]).padding(0.4);\n    var x1 = d3.scaleBand().domain(['Engagement', 'Sentiment']).rangeRound([0, x0.bandwidth()]).padding(0.05);\n    var y0 = d3.scaleLinear().range([height, 0]) //.domain([0,Math.max(...eng)]);\n    .domain([0, d3.max(post_data, function (d) {\n      return d.values[3].value + d.values[4].value + d.values[5].value;\n    })]);\n    var y1 = d3.scaleLinear().range([height, 0]).domain([0, 100]);\n    var color = d3.scaleOrdinal(['#63A37B', '#F15645', '#E5E5E5', '#005282', '#336D90', '#6692AC']);\n    var xAxis = d3.axisBottom(x0) //.scale(x0)\n    .ticks(5);\n    var yAxisLeft = d3.axisLeft(y0) //.scale(y0)\n    .tickFormat(function (d) {\n      return d3.format(\".00001%\")(d / 100);\n    });\n    var yAxisRight = d3.axisRight(y1) // .scale(y1)\n    .tickFormat(function (d) {\n      return parseInt(d);\n    });\n    var svg = d3.select(d3Container.current).attr('class', 'root_barchart').attr(\"preserveAspectRatio\", \"xMinYMin meet\").attr(\"viewBox\", \"0 0 600 400\").append(\"svg\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\"); // Ticks on x-axis and y-axis\n\n    var xAxisG = svg.append(\"g\").attr(\"class\", \"x axis\").attr(\"transform\", \"translate(0,\" + height + \")\").call(xAxis) //.selectAll(\".tick text\")\n    //.call(wrap, x0.bandwidth())\n    .selectAll(\"text\").style(\"text-anchor\", \"end\").attr(\"dx\", \"0.8em\").attr(\"dy\", \"1em\").attr('overflow', 'visible').attr(\"transform\", \"rotate(-25)\").style('text-decoration', 'underline').attr('fill', '#000000');\n    xAxisG.select(\".tick text\").attr('fill', '#005282');\n    svg.append(\"g\").attr(\"class\", \"y0 axis\").call(yAxisLeft).append(\"text\").attr(\"transform\", \"rotate(-90)\").attr(\"y\", 6).attr(\"dy\", \".71em\").style(\"text-anchor\", \"end\").style(\"fill\", \"#005282\").text(\"Engagement\");\n    svg.select('.x axis').selectAll('text').style(\"fill\", \"#07737F\");\n    svg.append(\"g\").attr(\"class\", \"y1 axis\").attr(\"transform\", \"translate(\" + width + \",0)\").call(yAxisRight).append(\"text\").attr(\"transform\", \"rotate(-90)\").attr(\"y\", -16).attr(\"dy\", \".71em\").style(\"text-anchor\", \"end\").style(\"fill\", \"#63A37B\").text(\"Sentiment\");\n    svg.select('.y1.axis').selectAll('.tick').style(\"fill\", \"#d0743c\"); // End ticks\n\n    var graph = svg.selectAll(\".date\").attr('class', 'graph').data(post_data) //.enter()\n    //.append(\"g\")\n    .join('g').attr(\"class\", \"g\").attr(\"transform\", function (d) {\n      return \"translate(\" + x0(d.postname) + \",0)\";\n    });\n    graph.selectAll(\"rect\").data(function (d) {\n      return d.values;\n    }).join('rect').attr(\"width\", x1.bandwidth()).attr(\"x\", function (d) {\n      return x1(stack_key_mapping[d.name]);\n    }).attr(\"y\", function (d) {\n      return d.yscale == 0 ? y0(d.yoffset) : y1(d.yoffset);\n    }).attr(\"height\", function (d) {\n      return height - (d.yscale == 0 ? y0(d.value) : y1(d.value));\n    }).attr(\"fill-opacity\", d => hover === '' ? 1 : hover === d.postName ? 1 : 0.5).style(\"fill\", function (d) {\n      return color(d.name);\n    }).style(\"cursor\", \"pointer\").on('mousemove', function (d) {\n      handleHover(d.name);\n      divTooltip.style('left', d3.event.pageX + 10 + 'px').style('top', d3.event.pageY - 25 + 'px').style('display', 'inline-block').html(stack_key_mapping[d.name] === 'Engagement' ? stack_key_mapping[d.name] + ' rate: ' + d.total.toFixed(3) + '%' + '</br>' + d.name + ': ' + Math.round(d.value * d.followers) + ' (rate: ' + d.value.toFixed(3) + '%)' : d.name + ': ' + d.value + ' %');\n    }).on('mouseout', function (d) {\n      setHoverSent('');\n      divTooltip.style('display', 'none');\n    }); //.on('mouseover', function(d){console.log(d.postName)})\n    // Legend\n\n    /*\n    var legend = svg.selectAll(\".legend\")\n        .data(['Engegment','Sentiment'].slice())\n        //.enter()\n        //.append(\"g\")\n        .join('g')\n        .attr(\"class\", \"legend\")\n        .attr(\"transform\", function(d, i) { return \"translate(0,\" + i * 20 + \")\"; });\n     legend.append(\"rect\")\n        .attr(\"x\", width - 48)\n        .attr(\"width\", 18)\n        .attr(\"height\", 18)\n        .style(\"fill\", color);\n     legend.append(\"text\")\n        .attr(\"x\", width - 54)\n        .attr(\"y\", 9)\n        .attr(\"dy\", \".35em\")\n        .style(\"text-anchor\", \"end\")\n        .text(function(d) { return d; });\n        */\n\n    function wrap(text, width) {\n      text.each(function () {\n        var text = d3.select(this),\n            words = text.text().split(/\\s+/).reverse(),\n            word,\n            line = [],\n            lineNumber = 0,\n            lineHeight = 1.1,\n            // ems\n        y = text.attr(\"y\"),\n            dy = parseFloat(text.attr(\"dy\")),\n            tspan = text.text(null).append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", dy + \"em\");\n\n        while (word = words.pop()) {\n          line.push(word);\n          tspan.text(line.join(\" \"));\n\n          if (tspan.node().getComputedTextLength() > width) {\n            line.pop();\n            tspan.text(line.join(\" \"));\n            line = [word];\n            tspan = text.append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", `${++lineNumber * lineHeight + dy}em`).text(word);\n          }\n        }\n      });\n    }\n  }, [choosenSentiment, hover]); // close useeffect\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"svg\", {\n      id: \"barChart\",\n      width: \"500\",\n      height: \"270\",\n      ref: d3Container\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n};\n\n_s(BarChart, \"lVkT8wYYC8FolEgkPieO/aSd+qU=\");\n\n_c = BarChart;\nexport default BarChart;\n\nvar _c;\n\n$RefreshReg$(_c, \"BarChart\");","map":{"version":3,"sources":["/Users/lovisaforsberg/MS_vis/ms_viz/src/components/barchart.js"],"names":["React","useContext","useEffect","useRef","useReducer","useState","createContext","d3","testData","SentimentContext","HoverSentContext","HoverContext","BarChart","SentSentimentContext","choosenSentiment","setChoosenSentiment","SentHoverSentContext","hoverSent","setHoverSent","SentHoverContext","hover","setHover","d3Container","post_data","keys","sent","eng","stack_key_mapping","getPosts","data","push","name","pos","comments","postname","values","value","yoffset","yscale","total","neg","neu","postName","followers","likes","shares","children","forEach","child","handleHover","type","select","selectAll","remove","margin","top","right","bottom","left","width","height","divTooltip","append","attr","x0","scaleBand","domain","rangeRound","padding","x1","bandwidth","y0","scaleLinear","range","max","d","y1","color","scaleOrdinal","xAxis","axisBottom","ticks","yAxisLeft","axisLeft","tickFormat","format","yAxisRight","axisRight","parseInt","svg","current","xAxisG","call","style","text","graph","join","on","event","pageX","pageY","html","toFixed","Math","round","wrap","each","words","split","reverse","word","line","lineNumber","lineHeight","y","dy","parseFloat","tspan","pop","node","getComputedTextLength"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useRef, useReducer, useState, createContext } from \"react\";\nimport * as d3 from 'd3'\nimport '../../node_modules/@ibm/plex/css/ibm-plex.css';\nimport '../style/barchart.css'\nimport testData from '../data/sveaskog.csv'\nimport {SentimentContext} from '../App'\nimport {HoverSentContext} from './graphContainer'\nimport {HoverContext} from \"../App\";\n\n\nconst BarChart = () =>{\n\n    const SentSentimentContext = useContext(SentimentContext);\n    const {choosenSentiment, setChoosenSentiment} = SentSentimentContext\n\n    const SentHoverSentContext = useContext(HoverSentContext)\n    const {hoverSent, setHoverSent} = SentHoverSentContext\n\n    const SentHoverContext = useContext(HoverContext);\n    const {hover, setHover} = SentHoverContext\n\n    const d3Container = useRef(null)\n\n    var post_data = []\n    var keys = []\n    var sent = []\n    var eng = []\n  \n   var stack_key_mapping={\n    \"Positive\":\"Sentiment\",\n    \"Negative\":\"Sentiment\",\n    \"Neutral\":\"Sentiment\",\n    \"Comments\":\"Engagement\",\n    \"Likes\":\"Engagement\",\n    \"Shares\":\"Engagement\"};\n\n    const getPosts = (data) =>{\n        if (!('children' in data)){\n            keys.push(data.name)\n            sent.push(data.pos)\n            eng.push(data.comments)\n            post_data.push({\n                postname: data.name,\n                values: [\n                    //{name: 'Engagement', com:data.comments, like: data.likes, share: data.shares, post:data.name},\n                    //{name: 'Sentiment', pos:data.pos, neg:data.neg, neu:data.neu, post:data.name}\n                    {name:'Positive', value:data.pos, yoffset: data.pos, yscale:1, total:(data.pos+data.neg+data.neu), postName:data.name},\n                    {name:'Negative', value:data.neg, yoffset:(data.neg+data.pos), yscale:1, total:(data.pos+data.neg+data.neu), postName:data.name},\n                    {name:'Neutral', value:data.neu, yoffset:(data.pos+data.neg+data.neu), yscale:1, total:(data.pos+data.neg+data.neu), postName:data.name},\n\n                    {name:'Comments', value:data.comments/(data.followers)*100, yoffset: data.comments/(data.followers)*100, yscale:0, total:(data.comments+data.likes+data.shares)/(data.followers)*100, postName:data.name, followers:data.followers},\n                    {name:'Likes', value:data.likes/(data.followers)*100, yoffset:(data.comments+data.likes)/(data.followers)*100, yscale:0, total:(data.comments+data.likes+data.shares)/(data.followers)*100, postName:data.name, followers:data.followers},\n                    {name:'Shares', value:data.shares/(data.followers)*100, yoffset: (data.comments+data.likes+data.shares)/(data.followers)*100, yscale:0, total:(data.comments+data.likes+data.shares)/(data.followers)*100, postName:data.name, followers:data.followers},\n                ]\n            })\n        }\n        else{\n            data.children.forEach(child =>{\n                getPosts(child)\n            })\n        }\n    }\n\n    const handleHover = (type) =>{\n        if(type === 'Likes' ||type === 'Comments' ||type === 'Shares'){\n            setHoverSent('eng')\n        }\n        else{\n            setHoverSent(type)\n        }\n    }\n\n    getPosts(choosenSentiment)\n\n    useEffect(()=>{\n\n        d3.select(\".root_barchart\").selectAll('*').remove()\n        d3.select(\".legend\").selectAll('*').remove()\n\n    var margin = {top: 20, right: 40, bottom: 30, left: 40},\n    width = 500 - margin.left - margin.right,\n    height = 250 - margin.top - margin.bottom;\n\n    var divTooltip = d3\n        .select('body')\n        .append('div')\n        .attr('class', 'toolTip')\n        .attr('font-size', '100px')\n\n    var x0 = d3.scaleBand()\n        .domain(keys)\n        .rangeRound([0, width])\n        .padding(0.4);\n\n    var x1 = d3.scaleBand()\n        .domain(['Engagement','Sentiment'])\n        .rangeRound([0, x0.bandwidth()])\n        .padding(0.05);\n\n    var y0 = d3.scaleLinear()\n        .range([height, 0])\n        //.domain([0,Math.max(...eng)]);\n        .domain([0, d3.max(post_data, function(d) { return d.values[3].value+d.values[4].value+d.values[5].value; })]);\n\n    var y1 = d3.scaleLinear()\n        .range([height, 0])\n        .domain([0,100]);\n        \n\n    var color = d3.scaleOrdinal(['#63A37B','#F15645', '#E5E5E5',\n                                '#005282', '#336D90', '#6692AC']);\n\n    var xAxis = d3.axisBottom(x0)\n        //.scale(x0)\n        .ticks(5);\n\n    var yAxisLeft = d3.axisLeft(y0)\n        //.scale(y0)\n        .tickFormat(function(d) {return d3.format(\".00001%\")(d/100)});\n\n    var yAxisRight = d3.axisRight(y1)\n       // .scale(y1)\n        .tickFormat(function(d) { return parseInt(d) });\n\n    var svg = d3.select(d3Container.current)\n        .attr('class', 'root_barchart')\n        .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\n        .attr(\"viewBox\", \"0 0 600 400\")\n        .append(\"svg\")\n        .attr(\"width\", width + margin.left + margin.right)\n        .attr(\"height\", height + margin.top + margin.bottom)\n        .append(\"g\")\n        .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n\n\n    // Ticks on x-axis and y-axis\n    var xAxisG = svg.append(\"g\")\n        .attr(\"class\", \"x axis\")\n        .attr(\"transform\", \"translate(0,\" + height + \")\")\n        \n        .call(xAxis)\n        //.selectAll(\".tick text\")\n        //.call(wrap, x0.bandwidth())\n        .selectAll(\"text\")\n        .style(\"text-anchor\", \"end\")\n        .attr(\"dx\", \"0.8em\")\n        .attr(\"dy\", \"1em\")\n        .attr('overflow', 'visible')\n        .attr(\"transform\", \"rotate(-25)\")\n        .style('text-decoration', 'underline')\n        .attr('fill', '#000000')\n\n        xAxisG.select(\".tick text\")\n        .attr('fill', '#005282');\n\n    svg.append(\"g\")\n        .attr(\"class\", \"y0 axis\")\n        .call(yAxisLeft)\n        .append(\"text\")\n        .attr(\"transform\", \"rotate(-90)\")\n        .attr(\"y\", 6)\n        .attr(\"dy\", \".71em\")\n        .style(\"text-anchor\", \"end\")\n        .style(\"fill\", \"#005282\")\n        .text(\"Engagement\");\n\n\n    svg.select('.x axis')\n    .selectAll('text')\n    .style(\"fill\",\"#07737F\");\n\n    svg.append(\"g\")\n        .attr(\"class\", \"y1 axis\")\n        .attr(\"transform\", \"translate(\" + width + \",0)\")\n        .call(yAxisRight)\n        .append(\"text\")\n        .attr(\"transform\", \"rotate(-90)\")\n        .attr(\"y\", -16)\n        .attr(\"dy\", \".71em\")\n        .style(\"text-anchor\", \"end\")\n        .style(\"fill\", \"#63A37B\")\n        .text(\"Sentiment\");\n\n    svg.select('.y1.axis')\n        .selectAll('.tick')\n        .style(\"fill\",\"#d0743c\");\n    // End ticks\n\n    var graph = svg.selectAll(\".date\")\n        .attr('class', 'graph')\n        .data(post_data)\n        //.enter()\n        //.append(\"g\")\n        .join('g')\n        .attr(\"class\", \"g\")\n        .attr(\"transform\", function(d) { return \"translate(\" + x0(d.postname) + \",0)\"; });\n        \n    graph.selectAll(\"rect\")\n        .data(function(d){return d.values})\n        .join('rect')\n        .attr(\"width\", x1.bandwidth())\n        .attr(\"x\", function(d) { return x1(stack_key_mapping[d.name]); })\n        .attr(\"y\", function(d) { return d.yscale==0 ? y0(d.yoffset) : y1(d.yoffset); })\n        .attr(\"height\", function(d) { return height - (d.yscale==0 ? y0(d.value) : y1(d.value)); })\n        .attr(\"fill-opacity\", (d)=>\n            hover === '' ? 1 : hover===d.postName ? 1 : 0.5\n        )\n        .style(\"fill\", function(d) { return color(d.name); })\n        .style(\"cursor\", \"pointer\")\n        .on('mousemove', function(d){\n            handleHover(d.name)\n            divTooltip\n            .style('left', d3.event.pageX+10+'px')\n            .style('top', d3.event.pageY-25+'px')\n            .style('display', 'inline-block')\n            .html(stack_key_mapping[d.name] === 'Engagement'?\n                stack_key_mapping[d.name]+' rate: '+(d.total).toFixed(3)+'%'+'</br>'+d.name+': '+Math.round((d.value)*(d.followers))+' (rate: '+(d.value).toFixed(3)+'%)':\n                d.name+': '+d.value+' %')\n        })\n        .on('mouseout', function(d){\n            setHoverSent('')\n          divTooltip.style('display', 'none')\n        })\n        //.on('mouseover', function(d){console.log(d.postName)})\n\n\n\n    // Legend\n    /*\n    var legend = svg.selectAll(\".legend\")\n        .data(['Engegment','Sentiment'].slice())\n        //.enter()\n        //.append(\"g\")\n        .join('g')\n        .attr(\"class\", \"legend\")\n        .attr(\"transform\", function(d, i) { return \"translate(0,\" + i * 20 + \")\"; });\n\n    legend.append(\"rect\")\n        .attr(\"x\", width - 48)\n        .attr(\"width\", 18)\n        .attr(\"height\", 18)\n        .style(\"fill\", color);\n\n    legend.append(\"text\")\n        .attr(\"x\", width - 54)\n        .attr(\"y\", 9)\n        .attr(\"dy\", \".35em\")\n        .style(\"text-anchor\", \"end\")\n        .text(function(d) { return d; });\n        */\n\n    function wrap(text, width) {\n        text.each(function() {\n        var text = d3.select(this),\n        words = text.text().split(/\\s+/).reverse(),\n        word,\n        line = [],\n        lineNumber = 0,\n        lineHeight = 1.1, // ems\n        y = text.attr(\"y\"),\n        dy = parseFloat(text.attr(\"dy\")),\n        tspan = text.text(null).append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", dy + \"em\")\n        while (word = words.pop()) {\n            line.push(word)\n            tspan.text(line.join(\" \"))\n            if (tspan.node().getComputedTextLength() > width) {\n                line.pop()\n                tspan.text(line.join(\" \"))\n                line = [word]\n                tspan = text.append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", `${++lineNumber * lineHeight + dy}em`).text(word)\n            }\n        }\n        })\n    }\n\n\n    },[choosenSentiment, hover]) // close useeffect\n\n    return(\n        <>\n            <svg id='barChart' width=\"500\" height=\"270\" ref={d3Container}></svg>\n\n        </>\n    )\n\n}\nexport default BarChart"]},"metadata":{},"sourceType":"module"}