{"ast":null,"code":"var _jsxFileName = \"/Users/lovisaforsberg/MS_vis/ms_viz/src/components/sunburst.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useRef, useReducer, useState, createContext } from \"react\";\nimport ReactTooltip from 'react-tooltip';\nimport * as d3 from 'd3';\nimport data from '../data/test.json';\nimport newdata from '../data/newstructure.json';\nimport { SentimentContext } from '../App';\nimport { HoverContext } from '../App';\nimport '../style/sunburst.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst SunBurst = () => {\n  _s();\n\n  const SentSentimentContext = useContext(SentimentContext);\n  const {\n    choosenSentiment,\n    setChoosenSentiment\n  } = SentSentimentContext;\n  const SentHoverContext = useContext(HoverContext);\n  const {\n    hover,\n    setHover\n  } = SentHoverContext;\n  const [choosenData, setChoosesData] = useState(choosenSentiment);\n  const [navText, setNavText] = useState('');\n  const [groupByChannel, setGroupByChannel] = useState(true);\n  const categories = ['around the block', 'block of the week', 'caves and cliffs', 'marketplace highlights', 'realms plus', 'taking inventory', 'engagement driver', 'pixel art', 'satisfying loops', 'community highlights', 'youtube support'];\n\n  const handleFilter = clicked => {\n    setChoosenSentiment(clicked); //console.log(clicked)\n  };\n\n  const handleHover = data => {\n    if ('post_content' in data) {\n      var ar = [];\n      ar.push(data.name);\n      setHover(ar);\n    } else if ('children' in data) {\n      var ar = [];\n      data.children.forEach(child => {\n        ar.push(child.name);\n      });\n      setHover(ar);\n    } else {\n      setHover([]);\n    }\n  };\n\n  const handleDataSet = click => {\n    if (click === 'cha') {\n      setChoosenSentiment(data.children[0]);\n      setChoosesData(data.children[0]);\n      setGroupByChannel(true);\n      document.getElementById('cha_button').className = 'groupButtonActive';\n      document.getElementById('cat_button').className = 'groupButtonInactive';\n    } else {\n      setChoosenSentiment(newdata.children[0]);\n      setChoosesData(newdata.children[0]);\n      setGroupByChannel(false);\n      document.getElementById('cat_button').className = 'groupButtonActive';\n      document.getElementById('cha_button').className = 'groupButtonInactive';\n    }\n  };\n\n  const handleData = channel => {\n    if (channel === 'fb') {\n      setChoosesData(data.children[0]);\n      setChoosenSentiment(data.children[0]);\n      document.getElementById('fb_button').className = 'channelButtonActive';\n      document.getElementById('ig_button').className = 'channelButtonInactive';\n      document.getElementById('tw_button').className = 'channelButtonInactive';\n    }\n\n    if (channel === 'ig') {\n      setChoosesData(data.children[1]);\n      setChoosenSentiment(data.children[1]);\n      document.getElementById('fb_button').className = 'channelButtonInactive';\n      document.getElementById('ig_button').className = 'channelButtonActive';\n      document.getElementById('tw_button').className = 'channelButtonInactive';\n    }\n\n    if (channel === 'tw') {\n      setChoosesData(data.children[2]);\n      setChoosenSentiment(data.children[2]);\n      document.getElementById('fb_button').className = 'channelButtonInactive';\n      document.getElementById('ig_button').className = 'channelButtonInactive';\n      document.getElementById('tw_button').className = 'channelButtonActive';\n    }\n  };\n\n  const handleOption = event => {\n    console.log(event.target.value);\n    setChoosenSentiment(newdata.children[event.target.value]);\n    setChoosesData(newdata.children[event.target.value]);\n  };\n\n  const d3Container = useRef(null);\n  useEffect(() => {\n    d3.select(\".root_sunburst\").selectAll('*').remove(); //setData(data)\n\n    const width = 500;\n    const radius = width / 7;\n\n    const partition = choosenData => {\n      const root = d3.hierarchy(choosenData).sum(d => d.eng_rate) //.sort((a, b) => b.value - a.value);\n      .sort(function (a, b) {\n        return d3.ascending(a.name, b.name);\n      });\n      return d3.partition().size([2 * Math.PI, root.height + 1])(root);\n    }; //var color = d3.scaleOrdinal(d3.quantize(d3.interpolateRainbow, data.children.length + 1));\n\n\n    var color = d3.scaleOrdinal(['#07737F', '#27306E', '#62254A', '#7C2438', '#A6193C', '#FFB86E']);\n    /*\n    var color = d3\n          .scaleOrdinal()\n          .range(['#CC5BA4', '#C65649', '#EAD94C', '#68AD7C', '#59A5CC'])\n          */\n\n    const format = d3.format(\",d\");\n    var divTooltip = d3.select('body').append('div').attr('class', 'toolTip').attr('font-size', '50px');\n    const arc = d3.arc().startAngle(d => d.x0).endAngle(d => d.x1).padAngle(d => Math.min((d.x1 - d.x0) / 2, 0.005)).padRadius(radius * 1.5).innerRadius(d => d.y0 * radius).outerRadius(d => Math.max(d.y0 * radius, d.y1 * radius - 1));\n    const root = partition(choosenData);\n    root.each(d => d.current = d);\n    const svg = d3.select(d3Container.current).attr('class', 'root_sunburst').append('svg') //.style(\"width\", \"100%\")\n    //.style(\"height\", \"auto\")\n    .style(\"font\", \"10px sans-serif\");\n    d3.select('#sunBurst').data(root.descendants().slice(1)).append('text').attr('class', 'NaviagationText').html(navText).attr(\"dy\", \"1em\");\n    const g = svg.append(\"g\").attr(\"transform\", `translate(${width / 2},${width / 2})`);\n    const path = g.append(\"g\").selectAll(\"path\").data(root.descendants().slice(1)).enter().append(\"path\").style(\"cursor\", \"pointer\") //.on('click', function(d){console.log(d.data)})\n    //.attr(\"fill\", d => { while (d.depth > 1) d = d.parent; return color(d.data.name); })\n    .attr('fill', d => groupByChannel ? d.depth === 1 ? d.data.color : d.parent.data.color : d.depth === 1 ? d.data.color : d.parent.data.color //d.depth === 2 ? d.data.color : d.depth === 3 ? d.parent.data.color : color(d.name)\n    //d.depth === 2 ?  d.depth === 3 ? d.data.parent.color : 'green' : d.data.color\n    ) //.attr(\"fill-opacity\", d => arcVisible(d.current) ? (d.children ? 1 : 0.8) : 0)\n    .attr(\"fill-opacity\", d => arcVisible(d.current) ? d.children ? 0.6 : 0.4 : 0).attr(\"d\", d => arc(d.current)).on('mousemove', function (d) {\n      divTooltip.style('left', d3.event.pageX + 10 + 'px').style('top', d3.event.pageY - 25 + 'px').style('display', 'inline-block').html(d.depth === 2 ? 'Post: ' + d.data.name : groupByChannel ? 'Category: ' + d.data.name : 'Channel: ' + d.data.name);\n    }).on('mouseout', function (d) {\n      divTooltip.style('display', 'none');\n      d3.select(this).attr(\"fill-opacity\", d => arcVisible(d.current) ? d.children ? 0.6 : 0.4 : 0);\n      handleHover([]);\n    }).on('click', clicked).on('mouseover', function (d) {\n      d3.select(this).attr(\"fill-opacity\", d => arcVisible(d.current) ? d.children ? 0.8 : 0.6 : 0);\n      handleHover(d.data); //console.log(d)\n    });\n    path.filter(d => d.children).style(\"cursor\", \"pointer\"); //.on(\"click\", clicked);\n\n    /*\n    path.append(\"title\")\n    // .text(d => `${d.ancestors().map(d => d.data.name).reverse().join(\"/\")}\\n${format(d.value)}`);\n    //.text(d => `${d.data.courseName}`);\n    .text('hejhej')\n    */\n\n    const label = g.append(\"g\").attr(\"pointer-events\", \"none\").attr(\"text-anchor\", \"middle\").style(\"user-select\", \"none\").selectAll(\"text\").data(root.descendants().slice(1)).join(\"text\").attr('class', 'pathLabel').attr(\"dy\", \"0.35em\").attr(\"fill-opacity\", d => +labelVisible(d.current)).attr(\"transform\", d => labelTransform(d.current))\n    /*\n    .attr(\"transform\", function(d) {return d.data.children !== undefined ?\n       \"translate(\" + arc.centroid(d) + \")rotate(\" + computeTextRotation(d) + \")\":\n       labelTransform(d.current)\n      })\n    */\n    .style('font-size', '10px').text(d => d.data.name)\n    /*\n    // SEE ONLY THE LABELS OF THE FIRST LEVEL\n       .style('visibility', function(d) {\n         return isTextVisible(d, 0) ? 'visible' : 'hidden';   \n     })\n     */\n    .style('visibility', 'visible').call(wrap, 20);\n\n    function computeTextRotation(d) {\n      var angle = (d.x0 + d.x1) / Math.PI * 90; // <-- 1\n      // Avoid upside-down labels\n\n      return angle < 90 || angle > 270 ? angle : angle + 180; // <--2 \"labels aligned with slices\"\n      // Alternate label formatting\n      //return (angle < 180) ? angle - 90 : angle + 90;  // <-- 3 \"labels as spokes\"\n    }\n\n    const parent = g.append(\"circle\").datum(root).attr(\"r\", radius).attr(\"fill\", \"none\").attr(\"pointer-events\", \"all\").style('cursor', 'pointer').on(\"click\", clicked);\n    /*\n      g.append(\"g\")\n      .selectAll(\"circle\")\n      .text('back')\n      .text(function(d){return d.current.data.name})\n      .attr('text-anchor', 'middle')\n      .attr('alignment-baseline', 'middle')\n      .style('font-size', '12px')\n      .style(\"cursor\", \"pointer\")\n      .attr(\"pointer-events\", \"all\")\n      .on(\"click\", function(d){console.log(d.data.name)});\n    */\n\n    const textParent = g.append(\"text\").datum(root).on('mouseover', function (d) {\n      console.log(d);\n    }).attr('id', 'backText').attr('class', 'zoomedOut').attr('text-anchor', 'middle').attr('alignment-baseline', 'middle').attr(\"pointer-events\", \"all\").attr('fill', '#404040').on(\"click\", clicked).style('font-size', '12px').style('cursor', 'pointer').html('');\n\n    function isTextVisible(d, depth) {\n      if (depth === 0) {\n        return d.depth === 0 || d.depth === 1;\n      } else {\n        return d.depth === depth || d.depth === depth - 1;\n      }\n    }\n\n    function clicked(p) {\n      /*\n      SEE ONLY LABEL ON FIRST LEVEL\n      d3.selectAll(\".pathLabel\")\n          .style('visibility', function(d2) {\n            return d2.depth > p.depth+1 ? 'hidden' : 'visible'\n          })\n          */\n      handleFilter(p.data);\n      parent.datum(p.parent || root);\n      textParent.datum(p.parent || root);\n\n      if (p.depth === 0) {\n        document.getElementById('backText').setAttribute(\"class\", \"zoomedOut\");\n      } else {\n        document.getElementById('backText').setAttribute(\"class\", \"zoomedIn\");\n      } //setZoomedData(p.data)\n\n\n      root.each(d => d.target = {\n        x0: Math.max(0, Math.min(1, (d.x0 - p.x0) / (p.x1 - p.x0))) * 2 * Math.PI,\n        x1: Math.max(0, Math.min(1, (d.x1 - p.x0) / (p.x1 - p.x0))) * 2 * Math.PI,\n        y0: Math.max(0, d.y0 - p.depth),\n        y1: Math.max(0, d.y1 - p.depth)\n      });\n      const t = g.transition().duration(1500); // Transition the data on all arcs, even the ones that aren’t visible,\n      // so that if this transition is interrupted, entering arcs will start\n      // the next transition from the desired position.\n\n      path.transition(t).tween(\"data\", d => {\n        const i = d3.interpolate(d.current, d.target);\n        return t => d.current = i(t);\n      }).filter(function (d) {\n        return +this.getAttribute(\"fill-opacity\") || arcVisible(d.target);\n      }).attr(\"fill-opacity\", d => arcVisible(d.target) ? d.children ? 0.6 : 0.4 : 0.4) //.attr(\"fill-opacity\", function(d){if(d.depth==2){return 0.8}if(d.depth==3){return 0.7}if(d.depth==4){return 0.5}} )\n      .attrTween(\"d\", d => () => arc(d.current));\n      label.filter(function (d) {\n        return +this.getAttribute(\"fill-opacity\") || labelVisible(d.target);\n      }).transition(t).attr(\"fill-opacity\", d => +labelVisible(d.target)).attrTween(\"transform\", d => () => labelTransform(d.current));\n    } //Aquí se le aumenta el número de arcos que muestra\n\n\n    function arcVisible(d) {\n      return d.y1 <= 4 && d.y0 >= 1 && d.x1 > d.x0;\n    }\n\n    function labelVisible(d) {\n      return d.y1 <= 5 && d.y0 >= 1 && (d.y1 - d.y0) * (d.x1 - d.x0) > 0.03;\n    }\n\n    function labelTransform(d) {\n      const x = (d.x0 + d.x1) / 2 * 180 / Math.PI;\n      const y = (d.y0 + d.y1) / 2 * radius;\n      return `rotate(${x - 90}) translate(${y},0) rotate(${x < 180 ? 0 : 180})`;\n    }\n\n    function wrap(text, width) {\n      text.each(function () {\n        var text = d3.select(this),\n            words = text.text().split(/\\s+/).reverse(),\n            word,\n            line = [],\n            lineNumber = 0,\n            lineHeight = 1,\n            // ems\n        y = text.attr(\"y\") - (words.length + 1) * 4,\n            dy = parseFloat(text.attr(\"dy\")),\n            tspan = text.text(null).append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", dy + \"em\");\n\n        while (word = words.pop()) {\n          line.push(word);\n          tspan.text(line.join(\" \"));\n\n          if (tspan.node().getComputedTextLength() > width) {\n            line.pop();\n            tspan.text(line.join(\" \"));\n            line = [word];\n            tspan = text.append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", ++lineNumber * lineHeight + dy + \"em\").text(word);\n          }\n        }\n      });\n    }\n  }, [choosenData]); // close useEffect\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sunburstBtn\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"btnContainer\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          id: \"cha_button\",\n          className: \"groupButtonActive\",\n          onClick: () => handleDataSet('cha'),\n          children: \"Group by Channel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 417,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          id: \"cat_button\",\n          className: \"groupButtonInactive\",\n          onClick: () => handleDataSet('cat'),\n          children: \"Group by Categories\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 418,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 416,\n        columnNumber: 7\n      }, this), groupByChannel ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"btnContainer\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          id: \"fb_button\",\n          className: \"channelButtonActive\",\n          onClick: () => handleData('fb'),\n          children: \"Facebook\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          id: \"ig_button\",\n          className: \"channelButtonInactive\",\n          onClick: () => handleData('ig'),\n          children: \"Instagram\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          id: \"tw_button\",\n          className: \"channelButtonInactive\",\n          onClick: () => handleData('tw'),\n          children: \"Twitter\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"btnContainer\",\n        children: /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"dropDown\",\n          onChange: e => handleOption(e),\n          children: categories.map((cat, i) => {\n            return /*#__PURE__*/_jsxDEV(\"option\", {\n              value: i,\n              children: cat\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 429,\n              columnNumber: 29\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 426,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"infoContainer\",\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-info-circle\",\n          \"data-tip\": true,\n          \"data-for\": \"sunburstInfo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 441,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(ReactTooltip, {\n          id: \"sunburstInfo\",\n          type: \"error\",\n          className: \"infoTooltip\",\n          place: \"bottom\",\n          textColor: \"#4d4d4d\",\n          backgroundColor: \"#FFDFC3\",\n          children: [groupByChannel ? /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"The graph shows all posts for each category in the choosen channel. \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 444,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"The graph shows all posts for each channel for the selected category \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 445,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"The size of each part represents the engagement rate.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 446,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Use the graph to zoom into specific categories or posts.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 447,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 440,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n        id: \"sunBurst\",\n        width: 500,\n        height: 500,\n        radius: 500 / 2,\n        ref: d3Container\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 452,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 415,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}; // close Areachart component\n\n\n_s(SunBurst, \"lzNE58lPDPF87wCe/KO2q9Ux6KM=\");\n\n_c = SunBurst;\nexport default SunBurst;\n\nvar _c;\n\n$RefreshReg$(_c, \"SunBurst\");","map":{"version":3,"sources":["/Users/lovisaforsberg/MS_vis/ms_viz/src/components/sunburst.js"],"names":["React","useContext","useEffect","useRef","useReducer","useState","createContext","ReactTooltip","d3","data","newdata","SentimentContext","HoverContext","SunBurst","SentSentimentContext","choosenSentiment","setChoosenSentiment","SentHoverContext","hover","setHover","choosenData","setChoosesData","navText","setNavText","groupByChannel","setGroupByChannel","categories","handleFilter","clicked","handleHover","ar","push","name","children","forEach","child","handleDataSet","click","document","getElementById","className","handleData","channel","handleOption","event","console","log","target","value","d3Container","select","selectAll","remove","width","radius","partition","root","hierarchy","sum","d","eng_rate","sort","a","b","ascending","size","Math","PI","height","color","scaleOrdinal","format","divTooltip","append","attr","arc","startAngle","x0","endAngle","x1","padAngle","min","padRadius","innerRadius","y0","outerRadius","max","y1","each","current","svg","style","descendants","slice","html","g","path","enter","depth","parent","arcVisible","on","pageX","pageY","filter","label","join","labelVisible","labelTransform","text","call","wrap","computeTextRotation","angle","datum","textParent","isTextVisible","p","setAttribute","t","transition","duration","tween","i","interpolate","getAttribute","attrTween","x","y","words","split","reverse","word","line","lineNumber","lineHeight","length","dy","parseFloat","tspan","pop","node","getComputedTextLength","e","map","cat"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useRef, useReducer, useState, createContext } from \"react\";\nimport ReactTooltip from 'react-tooltip';\nimport * as d3 from 'd3'\nimport data from '../data/test.json'\nimport newdata from '../data/newstructure.json'\nimport {SentimentContext} from '../App'\nimport {HoverContext} from '../App'\nimport '../style/sunburst.css'\n\n\nconst SunBurst = ()=> {\n\n  const SentSentimentContext = useContext(SentimentContext);\n  const {choosenSentiment, setChoosenSentiment} = SentSentimentContext\n\n  const SentHoverContext = useContext(HoverContext);\n  const {hover, setHover} = SentHoverContext\n\n  const [choosenData, setChoosesData] = useState(choosenSentiment)\n  const [navText, setNavText] = useState('')\n\n  const [groupByChannel, setGroupByChannel] = useState(true)\n\n  const categories = ['around the block', 'block of the week', 'caves and cliffs', 'marketplace highlights', 'realms plus', 'taking inventory', 'engagement driver', 'pixel art', 'satisfying loops', 'community highlights', 'youtube support']\n\n  const handleFilter = (clicked) => {\n    setChoosenSentiment(clicked)\n    //console.log(clicked)\n  }\n  const handleHover = (data) => {\n    if('post_content' in data){\n      var ar = []\n      ar.push(data.name)\n      setHover(ar)\n    }\n    else if('children' in data){\n      var ar = []\n      data.children.forEach(child=>{\n        ar.push(child.name)\n      })\n      setHover(ar)\n    }\n    else{\n      setHover([])\n    }\n  }\n\n  const handleDataSet = (click) =>{\n    if(click === 'cha'){\n      setChoosenSentiment(data.children[0])\n      setChoosesData(data.children[0])\n      setGroupByChannel(true)\n      document.getElementById('cha_button').className = 'groupButtonActive'\n      document.getElementById('cat_button').className = 'groupButtonInactive'\n\n\n    }\n    else{\n      setChoosenSentiment(newdata.children[0])\n      setChoosesData(newdata.children[0])\n      setGroupByChannel(false)\n      document.getElementById('cat_button').className = 'groupButtonActive'\n      document.getElementById('cha_button').className = 'groupButtonInactive'\n\n\n    }\n}\n\n  const handleData = (channel) =>{\n    if (channel === 'fb'){\n      setChoosesData(data.children[0])\n      setChoosenSentiment(data.children[0])\n      document.getElementById('fb_button').className = 'channelButtonActive'\n      document.getElementById('ig_button').className = 'channelButtonInactive'\n      document.getElementById('tw_button').className = 'channelButtonInactive'\n\n    }\n    if (channel === 'ig'){\n      setChoosesData(data.children[1])\n      setChoosenSentiment(data.children[1])\n      document.getElementById('fb_button').className = 'channelButtonInactive'\n      document.getElementById('ig_button').className = 'channelButtonActive'\n      document.getElementById('tw_button').className = 'channelButtonInactive'\n    }\n    if (channel === 'tw'){\n      setChoosesData(data.children[2])\n      setChoosenSentiment(data.children[2])\n      document.getElementById('fb_button').className = 'channelButtonInactive'\n      document.getElementById('ig_button').className = 'channelButtonInactive'\n      document.getElementById('tw_button').className = 'channelButtonActive'\n    }\n  }\n\n  const handleOption = (event) =>{\n    console.log(event.target.value)\n    setChoosenSentiment(newdata.children[event.target.value])\n    setChoosesData(newdata.children[event.target.value])\n  }\n\n\n    const d3Container = useRef(null)\n\n    useEffect(()=>{\n    \n    d3.select(\".root_sunburst\").selectAll('*').remove()\n\n    //setData(data)\n\n    const width = 500\n    const radius = width / 7\n\n\n    const partition = choosenData => {\n        const root = d3.hierarchy(choosenData)\n        .sum(d => (d.eng_rate))\n        //.sort((a, b) => b.value - a.value);\n        .sort(function(a, b) { return d3.ascending(a.name, b.name); })\n\n        return d3.partition()\n        .size([2 * Math.PI, root.height + 1])\n        (root);\n      }\n  \n        //var color = d3.scaleOrdinal(d3.quantize(d3.interpolateRainbow, data.children.length + 1));\n        var color = d3\n              .scaleOrdinal(['#07737F','#27306E', '#62254A', '#7C2438', '#A6193C', '#FFB86E'])\n        /*\n        var color = d3\n              .scaleOrdinal()\n              .range(['#CC5BA4', '#C65649', '#EAD94C', '#68AD7C', '#59A5CC'])\n              */\n\n      const format = d3.format(\",d\");\n\n      var divTooltip = d3\n        .select('body')\n        .append('div')\n        .attr('class', 'toolTip')\n        .attr('font-size', '50px')\n\n\n      const arc = d3.arc()\n        .startAngle(d => d.x0)\n        .endAngle(d => d.x1)\n        .padAngle(d => Math.min((d.x1 - d.x0) / 2, 0.005))\n        .padRadius(radius * 1.5)\n        .innerRadius(d => d.y0 * radius)\n        .outerRadius(d => (Math.max(d.y0 * radius, d.y1 * radius - 1)));\n\n      const root = partition(choosenData);\n\n      root.each(d => d.current = d);\n\n\n\n\nconst svg = d3.select(d3Container.current)\n    .attr('class', 'root_sunburst')\n    .append('svg')\n    //.style(\"width\", \"100%\")\n    //.style(\"height\", \"auto\")\n    .style(\"font\", \"10px sans-serif\");\n\n\nd3.select('#sunBurst')\n.data(root.descendants().slice(1))\n.append('text')\n.attr('class', 'NaviagationText')\n.html(navText)\n.attr(\"dy\", \"1em\")\n\nconst g = svg.append(\"g\")\n    .attr(\"transform\", `translate(${width/2},${width/2})`);\n\nconst path = g.append(\"g\")\n.selectAll(\"path\")\n.data(root.descendants().slice(1))\n.enter().append(\"path\")\n.style(\"cursor\", \"pointer\")\n//.on('click', function(d){console.log(d.data)})\n  //.attr(\"fill\", d => { while (d.depth > 1) d = d.parent; return color(d.data.name); })\n  .attr('fill', d=> groupByChannel ? d.depth === 1 ? d.data.color : d.parent.data.color :\n  d.depth === 1 ? d.data.color : d.parent.data.color\n  //d.depth === 2 ? d.data.color : d.depth === 3 ? d.parent.data.color : color(d.name)\n  //d.depth === 2 ?  d.depth === 3 ? d.data.parent.color : 'green' : d.data.color\n  \n  )\n  //.attr(\"fill-opacity\", d => arcVisible(d.current) ? (d.children ? 1 : 0.8) : 0)\n  .attr(\"fill-opacity\", d => arcVisible(d.current) ? (d.children ? 0.6 : 0.4) : 0)\n\n  .attr(\"d\", d => arc(d.current))\n\n  .on('mousemove', function(d){\n      divTooltip\n      .style('left', d3.event.pageX+10+'px')\n      .style('top', d3.event.pageY-25+'px')\n      .style('display', 'inline-block')\n      .html(d.depth === 2 ? 'Post: '+d.data.name : groupByChannel ? 'Category: '+d.data.name: 'Channel: '+d.data.name)\n  })\n  .on('mouseout', function(d){\n    divTooltip.style('display', 'none')\n    d3.select(this).attr(\"fill-opacity\", d => arcVisible(d.current) ? (d.children ? 0.6 : 0.4) : 0)\n    handleHover([])\n  })\n  .on('click', clicked)\n  \n  .on('mouseover', function(d){\n    d3.select(this).attr(\"fill-opacity\", d => arcVisible(d.current) ? (d.children ? 0.8 : 0.6) : 0)\n    handleHover(d.data)\n    //console.log(d)\n  })\n\n\n\npath.filter(d => d.children)\n    .style(\"cursor\", \"pointer\")\n    //.on(\"click\", clicked);\n\n\n    /*\npath.append(\"title\")\n   // .text(d => `${d.ancestors().map(d => d.data.name).reverse().join(\"/\")}\\n${format(d.value)}`);\n    //.text(d => `${d.data.courseName}`);\n    .text('hejhej')\n    */\n\n  const label = g\n  .append(\"g\")\n  .attr(\"pointer-events\", \"none\")\n  .attr(\"text-anchor\", \"middle\")\n  .style(\"user-select\", \"none\")\n  .selectAll(\"text\")\n  .data(root.descendants().slice(1))\n  .join(\"text\")\n  .attr('class', 'pathLabel')\n  .attr(\"dy\", \"0.35em\")\n  .attr(\"fill-opacity\", d => +labelVisible(d.current))\n  .attr(\"transform\", d => labelTransform(d.current))\n  /*\n  .attr(\"transform\", function(d) {return d.data.children !== undefined ?\n     \"translate(\" + arc.centroid(d) + \")rotate(\" + computeTextRotation(d) + \")\":\n     labelTransform(d.current)\n    })\n  */\n  \n  .style('font-size', '10px')\n  .text(d=> d.data.name)\n /*\n // SEE ONLY THE LABELS OF THE FIRST LEVEL\n    .style('visibility', function(d) {\n      return isTextVisible(d, 0) ? 'visible' : 'hidden';   \n  })\n  */\n .style('visibility', 'visible')\n  .call(wrap, 20);\n\n  function computeTextRotation(d) {\n    var angle = (d.x0 + d.x1) / Math.PI * 90;  // <-- 1\n\n    // Avoid upside-down labels\n    return (angle < 90 || angle > 270) ? angle : angle + 180;  // <--2 \"labels aligned with slices\"\n\n    // Alternate label formatting\n    //return (angle < 180) ? angle - 90 : angle + 90;  // <-- 3 \"labels as spokes\"\n}\n\n\nconst parent = g.append(\"circle\")\n    .datum(root)\n    .attr(\"r\", radius)\n    .attr(\"fill\", \"none\")\n    .attr(\"pointer-events\", \"all\")\n    .style('cursor', 'pointer')\n    .on(\"click\", clicked)\n/*\n  g.append(\"g\")\n  .selectAll(\"circle\")\n  .text('back')\n  .text(function(d){return d.current.data.name})\n  .attr('text-anchor', 'middle')\n  .attr('alignment-baseline', 'middle')\n  .style('font-size', '12px')\n  .style(\"cursor\", \"pointer\")\n  .attr(\"pointer-events\", \"all\")\n  .on(\"click\", function(d){console.log(d.data.name)});\n*/\n\nconst textParent = g.append(\"text\")\n  .datum(root)\n  .on('mouseover', function(d){console.log(d)})\n  .attr('id', 'backText')\n  .attr('class', 'zoomedOut')\n  .attr('text-anchor', 'middle')\n  .attr('alignment-baseline', 'middle')\n  .attr(\"pointer-events\", \"all\")\n  .attr('fill', '#404040')\n  .on(\"click\", clicked)\n\n  .style('font-size', '12px')\n  .style('cursor', 'pointer')\n  .html('')\n\n\nfunction isTextVisible(d, depth){\n    if (depth === 0){\n      return d.depth === 0 || d.depth === 1;\n    } else {\n      return d.depth === depth || d.depth === depth - 1;\n    }\n  }\n\n\n\nfunction clicked(p) {\n  \n  /*\n  SEE ONLY LABEL ON FIRST LEVEL\n d3.selectAll(\".pathLabel\")\n      .style('visibility', function(d2) {\n        return d2.depth > p.depth+1 ? 'hidden' : 'visible'\n      })\n      */\n\n  handleFilter(p.data)\n  parent.datum(p.parent || root);\n  textParent.datum(p.parent || root);\n\n  if(p.depth === 0){\n    document.getElementById('backText').setAttribute(\"class\", \"zoomedOut\")\n  }\n  else{\n    document.getElementById('backText').setAttribute(\"class\", \"zoomedIn\")\n  }\n  \n  \n//setZoomedData(p.data)\n\n  root.each(d => d.target = {\n    x0: Math.max(0, Math.min(1, (d.x0 - p.x0) / (p.x1 - p.x0))) * 2 * Math.PI,\n    x1: Math.max(0, Math.min(1, (d.x1 - p.x0) / (p.x1 - p.x0))) * 2 * Math.PI,\n    y0: Math.max(0, d.y0 - p.depth),\n    y1: Math.max(0, d.y1 - p.depth)\n  });\n\n  const t = g.transition().duration(1500);\n\n  // Transition the data on all arcs, even the ones that aren’t visible,\n  // so that if this transition is interrupted, entering arcs will start\n  // the next transition from the desired position.\n  path.transition(t)\n      .tween(\"data\", d => {\n        const i = d3.interpolate(d.current, d.target);\n        return t => d.current = i(t);\n      })\n    .filter(function(d) {\n      return +this.getAttribute(\"fill-opacity\") || arcVisible(d.target);\n    })\n      .attr(\"fill-opacity\", d => arcVisible(d.target) ? (d.children ? 0.6 : 0.4) : 0.4)\n      //.attr(\"fill-opacity\", function(d){if(d.depth==2){return 0.8}if(d.depth==3){return 0.7}if(d.depth==4){return 0.5}} )\n\n      .attrTween(\"d\", d => () => arc(d.current));\n\n  label.filter(function(d) {\n      return +this.getAttribute(\"fill-opacity\") || labelVisible(d.target);\n    }).transition(t)\n      .attr(\"fill-opacity\", d => +labelVisible(d.target))      \n      .attrTween(\"transform\", d => () => labelTransform(d.current));\n\n}\n\n//Aquí se le aumenta el número de arcos que muestra\nfunction arcVisible(d) {\n  return d.y1 <= 4 && d.y0 >= 1 && d.x1 > d.x0;\n}\n\n\nfunction labelVisible(d) {\n  return d.y1 <= 5 && d.y0 >= 1 && (d.y1 - d.y0) * (d.x1 - d.x0) > 0.03;\n}\n\nfunction labelTransform(d) {\n  const x = (d.x0 + d.x1) / 2 * 180 / Math.PI;\n  const y = (d.y0 + d.y1) / 2 * radius;\n  return `rotate(${x - 90}) translate(${y},0) rotate(${x < 180 ? 0 : 180})`;\n}\n\nfunction wrap(text, width) {\n  text.each(function () {\n      var text = d3.select(this),\n          words = text.text().split(/\\s+/).reverse(),\n          word,\n          line = [],\n          lineNumber = 0,\n          lineHeight = 1, // ems\n          y = text.attr(\"y\")-((words.length+1)*4),\n          dy = parseFloat(text.attr(\"dy\")),\n          tspan = text.text(null).append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", dy + \"em\");\n      while (word = words.pop()) {\n          line.push(word);\n          tspan.text(line.join(\" \"));\n          if (tspan.node().getComputedTextLength() > width) {\n              line.pop();\n              tspan.text(line.join(\" \"));\n              line = [word];\n              tspan = text.append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", ++lineNumber * lineHeight + dy + \"em\").text(word);\n          }\n      }\n  });\n}\n\n    }, [choosenData]) // close useEffect\n\n    return(\n      <>\n      <div className='sunburstBtn'>\n      <div className='btnContainer'>\n          <button id='cha_button' className='groupButtonActive' onClick={()=>handleDataSet('cha')}>Group by Channel</button>\n          <button id='cat_button' className='groupButtonInactive' onClick={()=>handleDataSet('cat')}>Group by Categories</button>\n        </div>\n        {groupByChannel ? \n          <div className='btnContainer'>\n            <button id='fb_button' className='channelButtonActive' onClick={()=>handleData('fb')}>Facebook</button>\n            <button id='ig_button' className='channelButtonInactive' onClick={()=>handleData('ig')}>Instagram</button>\n            <button id='tw_button'className='channelButtonInactive' onClick={()=>handleData('tw')}>Twitter</button>\n          </div>:\n          <div className='btnContainer'>\n            <select className='dropDown' onChange={e=>handleOption(e)}>\n            {categories.map((cat, i)=>{\n                    return (<option value={i}>{cat}</option>)             \n                })}\n  \n            </select>\n            {/*\n            {categories.map( cat=>{\n                    return (<button id='fb_button' className='channelButtonActive small' onClick={()=>handleData('fb')}>{cat}</button>)             \n                })}\n              */}\n          </div>\n          }\n          <div className='infoContainer'>\n            <i className=\"fas fa-info-circle\" data-tip data-for='sunburstInfo'></i>\n            <ReactTooltip id='sunburstInfo' type='error' className=\"infoTooltip\" place=\"bottom\" textColor='#4d4d4d' backgroundColor='#FFDFC3'>\n              {groupByChannel ?\n              <p>The graph shows all posts for each category in the choosen channel. </p>:\n              <p>The graph shows all posts for each channel for the selected category </p>}\n              <p>The size of each part represents the engagement rate.</p>\n              <p>Use the graph to zoom into specific categories or posts.</p>\n\n            </ReactTooltip>\n          </div>\n\n          <svg id='sunBurst' width={500} height={500} radius={500/2} ref={d3Container}></svg>\n      </div>\n      </>\n    )\n\n} // close Areachart component\nexport default SunBurst; \n"]},"metadata":{},"sourceType":"module"}