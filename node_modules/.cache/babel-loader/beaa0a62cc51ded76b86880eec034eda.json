{"ast":null,"code":"var _jsxFileName = \"/Users/lovisaforsberg/MS_vis/ms_viz/src/components/area_chart.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useRef, useReducer, useState, createContext } from \"react\";\nimport * as d3 from 'd3';\nimport testData from '../data/test.csv';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst AreaChart = () => {\n  _s();\n\n  const d3Container = useRef(null);\n  useEffect(() => {\n    d3.select(\".root\").selectAll('*').remove();\n    var margin = {\n      top: 20,\n      right: 30,\n      bottom: 30,\n      left: 40\n    },\n        width = 960 - margin.left - margin.right,\n        height = 500 - margin.top - margin.bottom;\n    var y = d3.scaleLinear().rangeRound([height, 0]).nice();\n    var x = d3.scaleBand().rangeRound([0, width]).paddingInner(0.05).align(0.1);\n    var z = d3.scaleOrdinal(['#63A37B', '#F15645', '#7D7D7D']); // Date format https://bl.ocks.org/zanarmstrong/ca0adb7e426c12c06a95\n\n    var parseTime = d3.timeParse(\"%b %Y\"); // Load stocks data\n    // Ex: 0: {symbol: \"MSFT\", date: \"Jan 2000\", price: \"39.81\"}\n\n    d3.csv('https://raw.githubusercontent.com/LyonDataViz/MOS5.5-Dataviz/master/data/stocks.csv').then(raw => {\n      var symbols = [];\n      var data = []; // Data pre-processing\n\n      raw.forEach(function (d, i) {\n        if (symbols.indexOf(d.symbol) < 0) {\n          symbols.push(d.symbol);\n          data[symbols.indexOf(d.symbol)] = [];\n        } // String to INT\n\n\n        d.value = +d.price; // Parsing time\n\n        d.date = parseTime(d.date);\n        data[symbols.indexOf(d.symbol)].push(d);\n      });\n      var data_nest = d3.nest().key(function (d) {\n        return d.date.getFullYear();\n      }).key(function (d) {\n        return d.symbol;\n      }).rollup(function (v) {\n        return d3.sum(v, function (d) {\n          return d.price;\n        });\n      }).entries(raw);\n      var years = data_nest.map(function (d) {\n        return d.key;\n      }); // d3-stack format https://github.com/d3/d3-shape/blob/master/README.md#stack_keys\n      // {MSFT: 356.07999999999987, AMZN: 527.17, IBM: 1162.97, AAPL: 260.98}\n\n      var data_stack = [];\n      data_nest.forEach(function (d, i) {\n        d.values = d.values.map(function (e) {\n          return e.value;\n        });\n        var t = {};\n        symbols.forEach(function (e, i) {\n          t[e] = d.values[i];\n        });\n        t.year = d.key;\n        data_stack.push(t);\n      });\n      var layers = d3.stack().keys(symbols)(data_stack);\n      var max = d3.max(layers[layers.length - 1], function (d) {\n        return d[1];\n      });\n      y.domain([0, max]);\n      x.domain(years);\n      console.log(symbols);\n      console.log(data_stack);\n      console.log(layers);\n      var svg = d3.select(d3Container.current).attr('class', 'root').append(\"svg\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n      svg.append(\"g\").selectAll(\"g\").data(layers).enter().append(\"g\").style(\"fill\", function (d) {\n        return z(d.key);\n      }).selectAll(\"rect\").data(function (d) {\n        return d;\n      }).enter().append(\"rect\").attr(\"x\", function (d, i) {\n        return x(d.data.year);\n      }).attr(\"y\", function (d) {\n        return y(d[1]);\n      }).attr(\"height\", function (d) {\n        return y(d[0]) - y(d[1]);\n      }).attr(\"width\", x.bandwidth());\n      svg.append(\"g\").attr(\"class\", \"x axis\").attr(\"transform\", \"translate(0,\" + height + \")\").call(d3.axisBottom(x));\n      svg.append(\"g\").attr(\"class\", \"y axis\").attr(\"transform\", \"translate(\" + 0 + \", 0)\").call(d3.axisLeft().scale(y));\n    });\n  }, []); // close useEffect\n\n  return /*#__PURE__*/_jsxDEV(\"svg\", {\n    id: \"areaChart\",\n    width: 600,\n    height: 400,\n    ref: d3Container\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 127,\n    columnNumber: 9\n  }, this);\n}; // close Areachart component\n\n\n_s(AreaChart, \"W4i3Ntv1V7JhLIB1f9IS/+wu8BI=\");\n\n_c = AreaChart;\nexport default AreaChart;\n\nvar _c;\n\n$RefreshReg$(_c, \"AreaChart\");","map":{"version":3,"sources":["/Users/lovisaforsberg/MS_vis/ms_viz/src/components/area_chart.js"],"names":["React","useContext","useEffect","useRef","useReducer","useState","createContext","d3","testData","AreaChart","d3Container","select","selectAll","remove","margin","top","right","bottom","left","width","height","y","scaleLinear","rangeRound","nice","x","scaleBand","paddingInner","align","z","scaleOrdinal","parseTime","timeParse","csv","then","raw","symbols","data","forEach","d","i","indexOf","symbol","push","value","price","date","data_nest","nest","key","getFullYear","rollup","v","sum","entries","years","map","data_stack","values","e","t","year","layers","stack","keys","max","length","domain","console","log","svg","current","attr","append","enter","style","bandwidth","call","axisBottom","axisLeft","scale"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useRef, useReducer, useState, createContext } from \"react\";\nimport * as d3 from 'd3'\nimport testData from '../data/test.csv'\n\n\nconst AreaChart = ()=> {\n\n    const d3Container = useRef(null)\n\n    useEffect(()=>{\n    \n    d3.select(\".root\").selectAll('*').remove()\n\n    var margin = {top: 20, right: 30, bottom: 30, left: 40},\n    width = 960 - margin.left - margin.right,\n    height = 500 - margin.top - margin.bottom;\n\nvar y = d3.scaleLinear()\n    .rangeRound([height, 0])\n\t\t.nice();\n\nvar x = d3.scaleBand()\n    .rangeRound([0, width])\n    .paddingInner(0.05)\n    .align(0.1)\n    \n    var z = d3.scaleOrdinal(['#63A37B','#F15645', '#7D7D7D']);\n\n  // Date format https://bl.ocks.org/zanarmstrong/ca0adb7e426c12c06a95\n  var parseTime  = d3.timeParse(\"%b %Y\")\n  \n  \n    // Load stocks data\n  // Ex: 0: {symbol: \"MSFT\", date: \"Jan 2000\", price: \"39.81\"}\n  d3.csv('https://raw.githubusercontent.com/LyonDataViz/MOS5.5-Dataviz/master/data/stocks.csv').then(raw =>{ \n    \n    var symbols = [];\n    var data = []\n    \n    // Data pre-processing\n    raw.forEach(function(d, i) {\n      \n      if(symbols.indexOf(d.symbol) < 0) {\n        symbols.push(d.symbol)\n        data[symbols.indexOf(d.symbol)] = [];\n      }\n      \n      // String to INT\n      d.value = +d.price;     \n \n      // Parsing time\n      d.date = parseTime(d.date)\n      data[symbols.indexOf(d.symbol)].push(d);\n    });\n    \n    var data_nest = d3.nest()\n    \t.key(function(d) { return d.date.getFullYear(); })\n    \t.key(function(d) { return d.symbol; })\n    \t.rollup(function(v) { return d3.sum(v, function(d) { return d.price; }); })\n\t\t\t.entries(raw);\n    \n    var years = data_nest.map(function(d) { return d.key; })\n    \n    // d3-stack format https://github.com/d3/d3-shape/blob/master/README.md#stack_keys\n    // {MSFT: 356.07999999999987, AMZN: 527.17, IBM: 1162.97, AAPL: 260.98}\n    var data_stack = []\n    \n    data_nest.forEach(function(d, i) {\n      d.values = d.values.map(function(e) { return e.value; })\n      var t ={}\n      symbols.forEach(function(e, i) {\n        t[e] = d.values[i]\n      })\n      t.year = d.key;\n      data_stack.push(t)\n    })\n    \n    \n    var layers = d3.stack().keys(symbols)(data_stack);\n\n    var max = d3.max(layers[layers.length-1], function(d) { return d[1]; });\n    \n    y.domain([0, max]);\n    x.domain(years);\n    \n    console.log(symbols)\n    console.log(data_stack)\n    console.log(layers)\n    \n    var svg = d3.select(d3Container.current)\n    .attr('class', 'root')\n      .append(\"svg\")\n        .attr(\"width\", width + margin.left + margin.right)\n        .attr(\"height\", height + margin.top + margin.bottom)\n      .append(\"g\")\n        .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n    svg.append(\"g\").selectAll(\"g\")\n          .data(layers)\n      .enter().append(\"g\")\n        .style(\"fill\", function(d) { return z(d.key); })\t\n        .selectAll(\"rect\")\n      .data(function(d) {  return d; })\n        .enter().append(\"rect\")\n          .attr(\"x\", function(d, i) { return x(d.data.year); })\n          .attr(\"y\", function(d) { return y(d[1]); })\n          .attr(\"height\", function(d) { return y(d[0]) - y(d[1]); })\n          .attr(\"width\", x.bandwidth());\n    \n    svg.append(\"g\")\n      .attr(\"class\", \"x axis\")\n      .attr(\"transform\", \"translate(0,\" + height + \")\")\n      .call(d3.axisBottom(x))\n    \n    svg.append(\"g\")\n      .attr(\"class\", \"y axis\")\n      .attr(\"transform\", \"translate(\" + (0) + \", 0)\")\n      .call(d3.axisLeft().scale(y))\n    \n    })\n\n\n\n    }, []) // close useEffect\n\n    return(\n        <svg id='areaChart' width={600} height={400} ref={d3Container}></svg>\n    )\n\n} // close Areachart component\nexport default AreaChart; \n"]},"metadata":{},"sourceType":"module"}