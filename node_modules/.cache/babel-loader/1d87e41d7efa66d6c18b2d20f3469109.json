{"ast":null,"code":"var _jsxFileName = \"/Users/lovisaforsberg/MS_vis/ms_viz/src/components/linechart.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useRef, useReducer, useState, createContext } from \"react\";\nimport * as d3 from 'd3';\nimport ReactTooltip from 'react-tooltip';\nimport '../style/linechart.css';\nimport { SentimentContext } from '../App';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst LineChart = () => {\n  _s();\n\n  const SentSentimentContext = useContext(SentimentContext);\n  const {\n    choosenSentiment,\n    setChoosenSentiment\n  } = SentSentimentContext;\n  const d3Container = useRef(null);\n  const [showSentiment, setShowSentiment] = useState(true); //const [data, setGraphData] = useState([])\n\n  function getRandomInt(min, max) {\n    min = Math.ceil(min);\n    max = Math.floor(max);\n    return Math.floor(Math.random() * (max - min) + min); //The maximum is exclusive and the minimum is inclusive\n  }\n\n  const handleOption = event => {\n    if (event.target.value === 'sent') {\n      setShowSentiment(true);\n    } else {\n      setShowSentiment(false);\n    }\n  };\n\n  const sent_data = [{\n    name: 'pos',\n    sent_name: 'Positive',\n    values: [{\n      date: 'August 2020',\n      price: getRandomInt(15, 40)\n    }, {\n      date: 'September 2020',\n      price: getRandomInt(15, 40)\n    }, {\n      date: 'October 2020',\n      price: getRandomInt(15, 40)\n    }, {\n      date: 'November 2020',\n      price: getRandomInt(15, 40)\n    }, {\n      date: 'December 2020',\n      price: getRandomInt(15, 40)\n    }, {\n      date: 'January 2021',\n      price: getRandomInt(15, 40)\n    }]\n  }, {\n    name: 'neg',\n    sent_name: 'Negative',\n    values: [{\n      date: 'August 2020',\n      price: getRandomInt(2, 18)\n    }, {\n      date: 'September 2020',\n      price: getRandomInt(2, 18)\n    }, {\n      date: 'October 2020',\n      price: getRandomInt(2, 18)\n    }, {\n      date: 'November 2020',\n      price: getRandomInt(2, 18)\n    }, {\n      date: 'December 2020',\n      price: getRandomInt(2, 18)\n    }, {\n      date: 'January 2021',\n      price: getRandomInt(2, 18)\n    }]\n  }, {\n    name: 'neu',\n    sent_name: 'Neutral',\n    values: [{\n      date: 'August 2020',\n      price: '54'\n    }, {\n      date: 'September 2020',\n      price: '55'\n    }, {\n      date: 'October 2020',\n      price: '57'\n    }, {\n      date: 'November 2020',\n      price: '53'\n    }, {\n      date: 'December 2020',\n      price: '52'\n    }, {\n      date: 'January 2021',\n      price: '59'\n    }]\n  }];\n  const eng_data = [{\n    name: 'pos',\n    eng_name: 'Comments',\n    values: [{\n      date: 'August 2020',\n      price: getRandomInt(1, 120) / 100\n    }, {\n      date: 'September 2020',\n      price: getRandomInt(1, 120) / 100\n    }, {\n      date: 'October 2020',\n      price: getRandomInt(1, 120) / 100\n    }, {\n      date: 'November 2020',\n      price: getRandomInt(1, 120) / 100\n    }, {\n      date: 'December 2020',\n      price: getRandomInt(1, 120) / 100\n    }, {\n      date: 'January 2021',\n      price: getRandomInt(1, 120) / 100\n    }]\n  }, {\n    name: 'neg',\n    eng_name: 'Likes',\n    values: [{\n      date: 'August 2020',\n      price: getRandomInt(1, 230) / 100\n    }, {\n      date: 'September 2020',\n      price: getRandomInt(1, 230) / 100\n    }, {\n      date: 'October 2020',\n      price: getRandomInt(1, 230) / 100\n    }, {\n      date: 'November 2020',\n      price: getRandomInt(1, 230) / 100\n    }, {\n      date: 'December 2020',\n      price: getRandomInt(1, 230) / 100\n    }, {\n      date: 'January 2021',\n      price: getRandomInt(1, 230) / 100\n    }]\n  }, {\n    name: 'neu',\n    eng_name: 'Shares',\n    values: [{\n      date: 'August 2020',\n      price: getRandomInt(1, 90) / 100\n    }, {\n      date: 'September 2020',\n      price: getRandomInt(1, 90) / 100\n    }, {\n      date: 'October 2020',\n      price: getRandomInt(1, 90) / 100\n    }, {\n      date: 'November 2020',\n      price: getRandomInt(1, 90) / 100\n    }, {\n      date: 'December 2020',\n      price: getRandomInt(1, 90) / 100\n    }, {\n      date: 'January 2021',\n      price: getRandomInt(1, 90) / 100\n    }]\n  }]; //const months = ['jan', 'feb', 'mars', 'april', 'may', 'june']\n\n  useEffect(() => {\n    const data = showSentiment ? sent_data : eng_data;\n    d3.select(\".root_linechart\").selectAll('*').remove();\n    var width = 400;\n    var height = 200; //var margin = 35;\n\n    var margin = {\n      top: 5,\n      right: 10,\n      bottom: 15,\n      left: 35\n    };\n    var duration = 250;\n    var lineOpacity = \"0.25\";\n    var lineOpacityHover = \"0.85\";\n    var otherLinesOpacityHover = \"0.1\";\n    var lineStroke = \"1.5px\";\n    var lineStrokeHover = \"2.5px\";\n    var circleOpacity = '0.85';\n    var circleOpacityOnLineHover = \"0.25\";\n    var circleRadius = 3;\n    var circleRadiusHover = 6;\n    var months = data[0].values.map(value => {\n      return value.date;\n    });\n    /* Scale */\n\n    var xScale = d3.scalePoint().domain(months).rangeRound([0, width - margin.left]);\n    var yScale = d3.scaleLinear().domain([0, showSentiment ? 100 : 2.3]).range([height - margin.bottom, 0]);\n    var color = d3.scaleOrdinal(['#63A37B', '#F15645', '#7D7D7D']);\n    var color_eng = d3.scaleOrdinal(['#005282', '#336D90', '#6692AC']);\n    /* Add SVG */\n\n    var svg = d3.select(d3Container.current).attr('class', 'root_linechart').append(\"svg\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).append('g').attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n    var tooltip = d3.select('#tooltip');\n    var tooltipLine = svg.append('line');\n    var divTooltip = d3.select('body').append('div').attr('class', 'toolTip').attr('font-size', '100px');\n    /* Add line into SVG */\n\n    var line = d3.line().x(d => xScale(d.date)).y(d => yScale(d.price));\n    let lines = svg.append('g').attr('class', 'lines');\n    lines.selectAll('.line-group').data(data).enter().append('g').attr('class', 'line-group').append('path').attr('class', 'line visible').attr('id', 'tja').attr('d', d => line(d.values)).style('stroke', (d, i) => showSentiment ? color(i) : color_eng(i)).style('opacity', lineOpacity);\n    /*transparent lines*/\n\n    lines.selectAll('.line-group-transparent').data(data).enter().append('g').attr('class', 'line-group-transparent').on(\"mouseover\", function (d, i) {\n      svg.append(\"text\").attr(\"class\", \"title-text\").style(\"fill\", showSentiment ? color(i) : color_eng(i)).text(showSentiment ? d.sent_name : d.eng_name).attr(\"text-anchor\", \"middle\").attr(\"x\", (width - margin.left) / 2).attr(\"y\", 5);\n    }).on(\"mouseout\", function (d) {\n      svg.select(\".title-text\").remove();\n    }).append('path').attr('class', 'line').attr('d', d => line(d.values)).style(\"stroke-width\", '4px').style('stroke', (d, i) => showSentiment ? color(i) : color_eng(i)).style('opacity', '1').on(\"mouseover\", function (d) {\n      d3.selectAll('.visible').style('opacity', otherLinesOpacityHover);\n      d3.selectAll('.circle').style('opacity', circleOpacityOnLineHover);\n      d3.select(this).style('opacity', lineOpacityHover).style(\"stroke-width\", lineStrokeHover).style(\"cursor\", \"pointer\");\n    }).on(\"mouseout\", function (d) {\n      d3.selectAll(\".visible\").style('opacity', lineOpacity);\n      d3.selectAll('.circle').style('opacity', circleOpacity);\n      d3.select(this).style(\"stroke-width\", lineStroke).style(\"cursor\", \"none\");\n    });\n    /* Add circles in the line */\n\n    lines.selectAll(\"circle-group\").data(data).enter().append(\"g\").style(\"fill\", (d, i) => showSentiment ? color(i) : color_eng(i)).selectAll(\"circle\").data(d => d.values).enter().append(\"g\").attr(\"class\", \"circle\").append(\"circle\").attr(\"cx\", d => xScale(d.date)).attr(\"cy\", d => yScale(d.price)).attr(\"r\", circleRadius).style('opacity', circleOpacity);\n    /* Add transoarent circles */\n\n    lines.selectAll(\"circle-group\").data(data).enter().append(\"g\").selectAll(\"circle\").data(d => d.values).enter().append(\"g\").attr(\"class\", \"circle\").on(\"mouseover\", function (d) {\n      drawTooltip(d.date);\n    }).on(\"mouseout\", function (d) {\n      removeTooltip();\n      divTooltip.style('display', 'none');\n    }).append(\"circle\").attr(\"cx\", d => xScale(d.date)).attr(\"cy\", d => yScale(d.price)).attr(\"r\", 6).style('opacity', '0').on(\"mouseover\", function (d) {\n      d3.select(this).transition().duration(duration).attr(\"r\", circleRadiusHover);\n    }).on(\"mouseout\", function (d) {\n      d3.select(this).transition().duration(duration).attr(\"r\", circleRadius);\n    });\n    /* Add Axis into SVG */\n\n    var xAxis = d3.axisBottom(xScale).ticks(5);\n    var yAxis = d3.axisLeft(yScale).ticks(5).tickFormat(function (d) {\n      return d + \"%\";\n    });\n    svg.append(\"g\").attr(\"class\", \"x axis\").attr(\"transform\", `translate(0, ${height - margin.bottom})`).call(xAxis).selectAll(\".tick text\").call(wrap, 20);\n    svg.append(\"g\").attr(\"class\", \"y axis\").call(yAxis).append('text').attr(\"y\", 15).attr('x', 5).attr(\"text-anchor\", \"start\").attr(\"transform\", \"rotate(-0)\").attr(\"fill\", \"#000\").text(showSentiment ? 'Sentiment [%]' : 'Engagement rate [%]');\n\n    function removeTooltip() {\n      if (tooltip) tooltip.style('display', 'none');\n      if (tooltipLine) tooltipLine.attr('stroke', 'none');\n    }\n\n    function drawTooltip(date) {\n      var pos = 0;\n      var neg = 0;\n      var neu = 0;\n      var values = [];\n      data.forEach(element => {\n        if (element.name === 'pos') {\n          element.values.forEach(month => {\n            if (month.date === date) {\n              pos = month.price;\n              values.push({\n                name: 'pos',\n                eng_name: 'Comments',\n                value: month.price\n              });\n            }\n          });\n        }\n\n        if (element.name === 'neg') {\n          element.values.forEach(month => {\n            if (month.date === date) {\n              neg = month.price;\n              values.push({\n                name: 'neg',\n                eng_name: 'Likes',\n                value: month.price\n              });\n            }\n          });\n        }\n\n        if (element.name === 'neu') {\n          element.values.forEach(month => {\n            if (month.date === date) {\n              neu = month.price;\n              values.push({\n                name: 'neu',\n                eng_name: 'Shares',\n                value: month.price\n              });\n            }\n          });\n        }\n      });\n      values.sort((a, b) => b.value - a.value);\n      tooltipLine.attr('stroke', 'grey').attr('x1', xScale(date)).attr('x2', xScale(date)).attr('y1', 0).attr('y2', height - margin.bottom);\n      divTooltip.style('left', d3.event.pageX + 10 + 'px').style('top', d3.event.pageY - 25 + 'px').style('display', 'inline-block').html(showSentiment ? values.map(item => {\n        return '<span class=dot_' + item.name + '></span> ' + item.value + '% </br>';\n      }) : values.map(item => {\n        return '<span class=dot_' + item.eng_name + '></span> ' + item.eng_name + ': ' + item.value + '% </br>';\n      }));\n    }\n\n    function wrap(text, width) {\n      text.each(function () {\n        var text = d3.select(this),\n            words = text.text().split(/\\s+/).reverse(),\n            word,\n            line = [],\n            lineNumber = 0,\n            lineHeight = 1,\n            // ems\n        y = text.attr(\"y\") - (words.length + 1) * 4,\n            dy = parseFloat(text.attr(\"dy\")),\n            tspan = text.text(null).append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", dy + \"em\");\n\n        while (word = words.pop()) {\n          line.push(word);\n          tspan.text(line.join(\" \"));\n\n          if (tspan.node().getComputedTextLength() > width) {\n            line.pop();\n            tspan.text(line.join(\" \"));\n            line = [word];\n            tspan = text.append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", ++lineNumber * lineHeight + dy + \"em\").text(word);\n          }\n        }\n      });\n    }\n  }, [choosenSentiment, showSentiment]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"lineContainer\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"line_infoContainer\",\n        children: [/*#__PURE__*/_jsxDEV(\"text\", {\n          style: {\n            marginRight: '8px'\n          },\n          className: \"NetFormula\",\n          children: [\" Showing change over time for: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: choosenSentiment.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 399,\n            columnNumber: 97\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 399,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-info-circle bar_info\",\n          \"data-tip\": true,\n          \"data-for\": \"linechartInfo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(ReactTooltip, {\n          id: \"linechartInfo\",\n          className: \"bar_infoTooltip\",\n          place: \"top\",\n          textColor: \"#4d4d4d\",\n          backgroundColor: \"#FFDFC3\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"The graph shows the engagemet rate or sentiment for \", /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"all posts\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 404,\n              columnNumber: 70\n            }, this), \" in the chosen category or channel per month\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"linechartContainer\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lineDropdownContainer\",\n          children: /*#__PURE__*/_jsxDEV(\"select\", {\n            className: \"LinedropDown\",\n            onChange: e => handleOption(e),\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"sent\",\n              children: \"Sentiment\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 413,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"eng\",\n              children: \"Engagement\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 414,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 412,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n          id: \"lineChart\",\n          width: \"440\",\n          height: \"220\",\n          ref: d3Container\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 421,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n\n_s(LineChart, \"j9CqNq8eSK34jGDLrHpwAzDlka8=\");\n\n_c = LineChart;\nexport default LineChart;\n\nvar _c;\n\n$RefreshReg$(_c, \"LineChart\");","map":{"version":3,"sources":["/Users/lovisaforsberg/MS_vis/ms_viz/src/components/linechart.js"],"names":["React","useContext","useEffect","useRef","useReducer","useState","createContext","d3","ReactTooltip","SentimentContext","LineChart","SentSentimentContext","choosenSentiment","setChoosenSentiment","d3Container","showSentiment","setShowSentiment","getRandomInt","min","max","Math","ceil","floor","random","handleOption","event","target","value","sent_data","name","sent_name","values","date","price","eng_data","eng_name","data","select","selectAll","remove","width","height","margin","top","right","bottom","left","duration","lineOpacity","lineOpacityHover","otherLinesOpacityHover","lineStroke","lineStrokeHover","circleOpacity","circleOpacityOnLineHover","circleRadius","circleRadiusHover","months","map","xScale","scalePoint","domain","rangeRound","yScale","scaleLinear","range","color","scaleOrdinal","color_eng","svg","current","attr","append","tooltip","tooltipLine","divTooltip","line","x","d","y","lines","enter","style","i","on","text","drawTooltip","removeTooltip","transition","xAxis","axisBottom","ticks","yAxis","axisLeft","tickFormat","call","wrap","pos","neg","neu","forEach","element","month","push","sort","a","b","pageX","pageY","html","item","each","words","split","reverse","word","lineNumber","lineHeight","length","dy","parseFloat","tspan","pop","join","node","getComputedTextLength","marginRight","e"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useRef, useReducer, useState, createContext } from \"react\";\nimport * as d3 from 'd3'\nimport ReactTooltip from 'react-tooltip';\nimport '../style/linechart.css'\nimport {SentimentContext} from '../App'\n\n\nconst LineChart = () =>{\n\n  const SentSentimentContext = useContext(SentimentContext);\n  const {choosenSentiment, setChoosenSentiment} = SentSentimentContext\n\n    const d3Container = useRef(null)\n\n    const [showSentiment, setShowSentiment] = useState(true)\n\n    //const [data, setGraphData] = useState([])\n\n    function getRandomInt(min, max) {\n      min = Math.ceil(min);\n      max = Math.floor(max);\n      return Math.floor(Math.random() * (max - min) + min); //The maximum is exclusive and the minimum is inclusive\n    }\n\n    const handleOption = (event) =>{\n      if(event.target.value ==='sent'){\n        setShowSentiment(true)\n      }\n      else{\n\n        setShowSentiment(false)\n      }\n    }\n\n    const sent_data = [\n      {name:'pos', sent_name:'Positive', values:[\n          {date:'August 2020', price: getRandomInt(15, 40)},\n          {date:'September 2020', price: getRandomInt(15, 40)},\n          {date:'October 2020', price: getRandomInt(15, 40)},\n          {date:'November 2020', price: getRandomInt(15, 40)},\n          {date:'December 2020', price: getRandomInt(15, 40)},\n          {date:'January 2021', price: getRandomInt(15, 40)},\n      ]},\n      {name:'neg', sent_name:'Negative', values:[\n          {date:'August 2020', price: getRandomInt(2, 18)},\n          {date:'September 2020', price: getRandomInt(2, 18)},\n          {date:'October 2020', price: getRandomInt(2, 18)},\n          {date:'November 2020', price: getRandomInt(2, 18)},\n          {date:'December 2020', price: getRandomInt(2, 18)},\n          {date:'January 2021', price: getRandomInt(2, 18)},\n      ]},\n      {name:'neu', sent_name:'Neutral', values:[\n          {date:'August 2020', price: '54'},\n          {date:'September 2020', price: '55'},\n          {date:'October 2020', price: '57'},\n          {date:'November 2020', price: '53'},\n          {date:'December 2020', price: '52'},\n          {date:'January 2021', price: '59'},\n      ]},\n    ]\n\n    const eng_data = [\n      {name:'pos', eng_name:'Comments', values:[\n          {date:'August 2020', price: getRandomInt(1,120)/100},\n          {date:'September 2020', price: getRandomInt(1,120)/100},\n          {date:'October 2020', price: getRandomInt(1,120)/100},\n          {date:'November 2020', price: getRandomInt(1,120)/100},\n          {date:'December 2020', price: getRandomInt(1,120)/100},\n          {date:'January 2021', price: getRandomInt(1,120)/100},\n      ]},\n      {name:'neg', eng_name:'Likes', values:[\n          {date:'August 2020', price: getRandomInt(1,230)/100},\n          {date:'September 2020', price: getRandomInt(1,230)/100},\n          {date:'October 2020', price: getRandomInt(1,230)/100},\n          {date:'November 2020', price: getRandomInt(1,230)/100},\n          {date:'December 2020', price: getRandomInt(1,230)/100},\n          {date:'January 2021', price: getRandomInt(1,230)/100},\n      ]},\n      {name:'neu', eng_name:'Shares', values:[\n          {date:'August 2020', price: getRandomInt(1,90)/100},\n          {date:'September 2020', price: getRandomInt(1,90)/100},\n          {date:'October 2020', price: getRandomInt(1,90)/100},\n          {date:'November 2020', price: getRandomInt(1,90)/100},\n          {date:'December 2020', price: getRandomInt(1,90)/100},\n          {date:'January 2021', price: getRandomInt(1,90)/100},\n      ]},\n    ]\n\n    \n\n\n    //const months = ['jan', 'feb', 'mars', 'april', 'may', 'june']\n\n    useEffect(()=>{\n\n    \n    const data = showSentiment?sent_data:eng_data\n\n    d3.select(\".root_linechart\").selectAll('*').remove()\n\n    var width = 400;\n    var height = 200;\n    //var margin = 35;\n    var margin = {top: 5, right: 10, bottom: 15, left: 35}\n\n    var duration = 250;\n\n    var lineOpacity = \"0.25\";\n    var lineOpacityHover = \"0.85\";\n    var otherLinesOpacityHover = \"0.1\";\n    var lineStroke = \"1.5px\";\n    var lineStrokeHover = \"2.5px\";\n\n    var circleOpacity = '0.85';\n    var circleOpacityOnLineHover = \"0.25\"\n    var circleRadius = 3;\n    var circleRadiusHover = 6;\n\nvar months = (data[0].values.map(value =>{return value.date}))\n\n\n/* Scale */\nvar xScale = d3.scalePoint()\n  .domain(months)\n  .rangeRound([0, width - margin.left])\n\n\nvar yScale = d3.scaleLinear()\n  .domain([0, showSentiment? 100: 2.3 ])\n  .range([height-margin.bottom, 0]);\n\nvar color = d3.scaleOrdinal(['#63A37B','#F15645', '#7D7D7D']);\n\nvar color_eng = d3.scaleOrdinal(['#005282', '#336D90', '#6692AC']);\n\n/* Add SVG */\nvar svg = d3.select(d3Container.current)\n.attr('class', 'root_linechart')\n.append(\"svg\")\n.attr(\"width\", width + margin.left + margin.right)\n.attr(\"height\", height + margin.top + margin.bottom)\n  .append('g')\n  .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n  var tooltip = d3.select('#tooltip');\n  var tooltipLine = svg.append('line');\n\n  var divTooltip = d3\n        .select('body')\n        .append('div')\n        .attr('class', 'toolTip')\n        .attr('font-size', '100px')\n\n\n/* Add line into SVG */\nvar line = d3.line()\n  .x(d => xScale(d.date))\n  .y(d => yScale(d.price));\n\nlet lines = svg.append('g')\n  .attr('class', 'lines');\n\n\nlines.selectAll('.line-group')\n  .data(data).enter()\n  .append('g')\n  .attr('class', 'line-group')  \n  .append('path')\n  .attr('class', 'line visible')  \n  .attr('id', 'tja')\n  .attr('d', d => line(d.values))\n  .style('stroke', (d, i) => showSentiment?color(i):color_eng(i))\n  .style('opacity', lineOpacity)\n  \n\n\n  \n\n/*transparent lines*/\nlines.selectAll('.line-group-transparent')\n  .data(data).enter()\n  .append('g')\n  .attr('class', 'line-group-transparent')  \n  .on(\"mouseover\", function(d, i) {\n      svg.append(\"text\")\n        .attr(\"class\", \"title-text\")\n        .style(\"fill\", showSentiment?color(i):color_eng(i))        \n        .text(showSentiment?d.sent_name:d.eng_name)\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"x\", (width-margin.left)/2)\n        .attr(\"y\", 5);\n    })\n  .on(\"mouseout\", function(d) {\n      svg.select(\".title-text\").remove();\n    })\n  .append('path')\n  .attr('class', 'line')  \n  .attr('d', d => line(d.values))\n  .style(\"stroke-width\", '4px')\n  .style('stroke', (d, i) => showSentiment?color(i):color_eng(i))\n\n  .style('opacity', '1')\n  .on(\"mouseover\", function(d) {\n    d3.selectAll('.visible')\n        .style('opacity', otherLinesOpacityHover);\n    d3.selectAll('.circle')\n        .style('opacity', circleOpacityOnLineHover);\n    d3.select(this)\n      .style('opacity', lineOpacityHover)\n      .style(\"stroke-width\", lineStrokeHover)\n      .style(\"cursor\", \"pointer\");\n  })\n.on(\"mouseout\", function(d) {\n    d3.selectAll(\".visible\")\n        .style('opacity', lineOpacity);\n    d3.selectAll('.circle')\n        .style('opacity', circleOpacity);\n    d3.select(this)\n      .style(\"stroke-width\", lineStroke)\n      .style(\"cursor\", \"none\");\n  });\n  \n\n\n/* Add circles in the line */\nlines.selectAll(\"circle-group\")\n  .data(data).enter()\n  .append(\"g\")\n  .style(\"fill\", (d, i) => showSentiment?color(i):color_eng(i))\n  .selectAll(\"circle\")\n  .data(d => d.values).enter()\n  .append(\"g\")\n  .attr(\"class\", \"circle\")  \n  .append(\"circle\")\n  .attr(\"cx\", d => xScale(d.date))\n  .attr(\"cy\", d => yScale(d.price))\n  .attr(\"r\", circleRadius)\n  .style('opacity', circleOpacity)\n  \n\n/* Add transoarent circles */\nlines.selectAll(\"circle-group\")\n  .data(data).enter()\n  .append(\"g\")\n  .selectAll(\"circle\")\n  .data(d => d.values).enter()\n  .append(\"g\")\n  .attr(\"class\", \"circle\")  \n  .on(\"mouseover\", function(d){drawTooltip(d.date)})\n  .on(\"mouseout\", \n    function(d){\n    removeTooltip()\n    divTooltip.style('display', 'none')\n    })\n  .append(\"circle\")\n  .attr(\"cx\", d => xScale(d.date))\n  .attr(\"cy\", d => yScale(d.price))\n  .attr(\"r\", 6)\n  .style('opacity', '0')\n  .on(\"mouseover\", function(d) {\n        d3.select(this)\n          .transition()\n          .duration(duration)\n          .attr(\"r\", circleRadiusHover);\n      })\n    .on(\"mouseout\", function(d) {\n        d3.select(this) \n          .transition()\n          .duration(duration)\n          .attr(\"r\", circleRadius);  \n      });\n\n\n/* Add Axis into SVG */\nvar xAxis = d3.axisBottom(xScale)\n            .ticks(5);\n\nvar yAxis = d3.axisLeft(yScale)\n            .ticks(5)\n            .tickFormat(function(d) {return d+ \"%\"});\n\nsvg.append(\"g\")\n  .attr(\"class\", \"x axis\")\n  .attr(\"transform\", `translate(0, ${height-margin.bottom})`)\n  .call(xAxis)\n  .selectAll(\".tick text\")\n  .call(wrap, 20)\n\nsvg.append(\"g\")\n  .attr(\"class\", \"y axis\")\n  .call(yAxis)\n  .append('text')\n  .attr(\"y\", 15)\n  .attr('x', 5)\n  .attr(\"text-anchor\", \"start\")\n  .attr(\"transform\", \"rotate(-0)\")\n  .attr(\"fill\", \"#000\")\n  .text(showSentiment?'Sentiment [%]':'Engagement rate [%]');\n\nfunction removeTooltip() {\n    if (tooltip) tooltip.style('display', 'none');\n    if (tooltipLine) tooltipLine.attr('stroke', 'none');\n  }\n\n  function drawTooltip(date) {\n\n    var pos = 0\n    var neg = 0\n    var neu = 0\n\n    var values = []\n    data.forEach(element => {\n        if(element.name === 'pos'){\n            element.values.forEach(month=>{\n                if (month.date === date){\n                    pos = month.price\n                    values.push({name:'pos', eng_name:'Comments', value:month.price})\n                }\n            })\n        }\n        if(element.name === 'neg'){\n            element.values.forEach(month=>{\n                if (month.date === date){\n                    neg = month.price\n                    values.push({name:'neg',eng_name:'Likes', value:month.price})\n\n                }\n            })\n        }\n        if(element.name === 'neu'){\n            element.values.forEach(month=>{\n                if (month.date === date){\n                    neu = month.price\n                    values.push({name:'neu', eng_name:'Shares', value:month.price})\n\n                }\n            })\n        }\n    });\n\n    values.sort((a, b) => b.value - a.value);\n\n      \n    tooltipLine.attr('stroke', 'grey')\n      .attr('x1', xScale(date))\n      .attr('x2', xScale(date))\n      .attr('y1', 0)\n      .attr('y2', height-margin.bottom);\n \n      divTooltip\n      .style('left', d3.event.pageX+10+'px')\n      .style('top', d3.event.pageY-25+'px')\n      .style('display', 'inline-block')\n      .html(showSentiment?\n        values.map(item=>{\n         return ('<span class=dot_'+(item.name)+'></span> '+(item.value) +'% </br>')\n        })\n        :\n        values.map(item=>{\n          return ('<span class=dot_'+(item.eng_name)+'></span> '+(item.eng_name)+': '+(item.value) +'% </br>')\n         })\n      \n      )\n \n  }\n\n  function wrap(text, width) {\n    text.each(function () {\n        var text = d3.select(this),\n            words = text.text().split(/\\s+/).reverse(),\n            word,\n            line = [],\n            lineNumber = 0,\n            lineHeight = 1, // ems\n            y = text.attr(\"y\")-((words.length+1)*4),\n            dy = parseFloat(text.attr(\"dy\")),\n            tspan = text.text(null).append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", dy + \"em\");\n        while (word = words.pop()) {\n            line.push(word);\n            tspan.text(line.join(\" \"));\n            if (tspan.node().getComputedTextLength() > width) {\n                line.pop();\n                tspan.text(line.join(\" \"));\n                line = [word];\n                tspan = text.append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", ++lineNumber * lineHeight + dy + \"em\").text(word);\n            }\n        }\n    });\n  }\n\n    }, [choosenSentiment, showSentiment])\n\n    return(\n        <>\n       \n      <div className='lineContainer'>\n\n        <div className='line_infoContainer'>\n        <text style={{marginRight:'8px'}} className='NetFormula'> Showing change over time for: <strong>{choosenSentiment.name}</strong></text>\n\n            <i className=\"fas fa-info-circle bar_info\" data-tip data-for='linechartInfo'></i>\n            <ReactTooltip id='linechartInfo' className=\"bar_infoTooltip\" place=\"top\" textColor='#4d4d4d' backgroundColor='#FFDFC3'>\n             \n              <p>The graph shows the engagemet rate or sentiment for <strong>all posts</strong> in the chosen category or channel per month</p>\n              \n\n            </ReactTooltip>        \n          </div>\n\n      <div className='linechartContainer'>\n            <div className='lineDropdownContainer'>\n              <select className='LinedropDown' onChange={e => handleOption(e)}>\n                <option value='sent'>Sentiment</option>    \n                <option value='eng'>Engagement</option>           \n              </select>\n            </div>\n          \n\n          \n          \n          <svg id='lineChart' width=\"440\" height=\"220\" ref={d3Container}></svg>\n          </div>\n          </div>\n        </>\n    )\n}\n\nexport default LineChart\n"]},"metadata":{},"sourceType":"module"}