{"ast":null,"code":"import React,{useContext,useEffect,useRef,useReducer,useState,createContext}from\"react\";import*as d3 from'd3';import import_data from'../data/channel_sentiment.csv';import'./linechart.css';/*\navg value to put in csv\navg,30,4,66,27,5,68,23,9,67\n*/import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var LineChart=function LineChart(){var d3Container=useRef(null);useEffect(function(){d3.select(\".root_linechart\").selectAll('*').remove();d3.csv(import_data).then(function(d){return chart(d);});function chart(data){var keys=data.columns.slice(1);var parseTime=d3.timeParse(\"%Y%m%d\"),formatDate=d3.timeFormat(\"%Y-%m-%d\"),bisectDate=d3.bisector(function(d){return d.date;}).left,formatValue=d3.format(\",.0f\");data.forEach(function(d){d.date=parseTime(d.date);return d;});var svg=d3.select(d3Container.current).attr('class','root_linechart'),margin={top:15,right:35,bottom:15,left:35},width=+svg.attr(\"width\")-margin.left-margin.right,height=+svg.attr(\"height\")-margin.top-margin.bottom;var x=d3.scaleTime().rangeRound([margin.left,width-margin.right]).domain(d3.extent(data,function(d){return d.date;}));var y=d3.scaleLinear().rangeRound([height-margin.bottom,margin.top]);var z=d3.scaleOrdinal(['#63A37B','#F15645','#7D7D7D']);var line=d3.line().curve(d3.curveCardinal).x(function(d){return x(d.date);}).y(function(d){return y(d.degrees);});svg.append(\"g\").attr(\"class\",\"x-axis\").style('color','#999').attr(\"transform\",\"translate(0,\"+(height-margin.bottom)+\")\").call(d3.axisBottom(x));svg.append(\"g\").attr(\"class\",\"y-axis\").style('color','#999').attr(\"transform\",\"translate(\"+margin.left+\",0)\");var focus=svg.append(\"g\").attr(\"class\",\"focus\").style(\"display\",\"none\");focus.append(\"line\").attr(\"class\",\"lineHover\").style(\"stroke\",\"#999\").attr(\"stroke-width\",1).style(\"shape-rendering\",\"crispEdges\").style(\"opacity\",0.5).attr(\"y1\",-height).attr(\"y2\",0);focus.append(\"text\").attr(\"class\",\"lineHoverDate\").attr(\"text-anchor\",\"middle\").attr(\"font-size\",12);var overlay=svg.append(\"rect\").attr(\"class\",\"overlay\").attr(\"x\",margin.left).attr(\"width\",width-margin.right-margin.left).attr(\"height\",height);update(d3.select('#selectbox').property('value'),0);function update(input,speed){var copy=keys.filter(function(f){return f.includes(input);});var cities=copy.map(function(id){return{id:id,values:data.map(function(d){return{date:d.date,degrees:+d[id]};})};});y.domain([//d3.min(cities, d => d3.min(d.values, c => c.degrees)),\n-5,d3.max(cities,function(d){return d3.max(d.values,function(c){return c.degrees;});})]).nice();svg.selectAll(\".y-axis\").transition().duration(speed).call(d3.axisLeft(y).tickSize(-width+margin.right+margin.left));var city=svg.selectAll(\".cities\").data(cities);city.exit().remove();city.enter().insert(\"g\",\".focus\").append(\"path\").attr(\"class\",\"line cities\").style(\"stroke\",function(d){return z(d.id);}).merge(city).transition().duration(speed).attr(\"d\",function(d){return line(d.values);});tooltip(copy);}function tooltip(copy){var labels=focus.selectAll(\".lineHoverText\").data(copy);labels.enter().append(\"text\").attr(\"class\",\"lineHoverText\").style(\"fill\",function(d){return z(d);}).attr(\"text-anchor\",\"start\").attr(\"font-size\",12).attr(\"dy\",function(_,i){return 1+i*2+\"em\";}).merge(labels);var circles=focus.selectAll(\".hoverCircle\").data(copy);circles.enter().append(\"circle\").attr(\"class\",\"hoverCircle\").style(\"fill\",function(d){return z(d);}).attr(\"r\",2.5).merge(circles);svg.selectAll(\".overlay\").on(\"mouseover\",function(){focus.style(\"display\",null);}).on(\"mouseout\",function(){focus.style(\"display\",\"none\");}).on(\"mousemove\",mousemove);function mousemove(){var x0=x.invert(d3.mouse(this)[0]),i=bisectDate(data,x0,1),d0=data[i-1],d1=data[i],d=x0-d0.date>d1.date-x0?d1:d0;focus.select(\".lineHover\").attr(\"transform\",\"translate(\"+x(d.date)+\",\"+height+\")\");focus.select(\".lineHoverDate\").attr(\"transform\",\"translate(\"+x(d.moth)+\",\"+(height+margin.bottom)+\")\").text(formatDate(d.date));focus.selectAll(\".hoverCircle\").attr(\"cy\",function(e){return y(d[e]);}).attr(\"cx\",x(d.date));focus.selectAll(\".lineHoverText\").attr(\"transform\",\"translate(\"+x(d.date)+\",\"+height/2.5+\")\")//.text(e => e + \" \"  + formatValue(d[e])+' %');\n.text(function(e){if(e.slice(0,3)==='pos'){return'Positive: '+formatValue(d[e])+' %';}else if(e.slice(0,3)==='neg'){return'Negative: '+formatValue(d[e])+' %';}else if(e.slice(0,3)==='neu'){return'Neatural: '+formatValue(d[e])+' %';}});x(d.date)>width-width/4?focus.selectAll(\"text.lineHoverText\").attr(\"text-anchor\",\"end\").attr(\"dx\",-10):focus.selectAll(\"text.lineHoverText\").attr(\"text-anchor\",\"start\").attr(\"dx\",10);}}var selectbox=d3.select(\"#selectbox\").on(\"change\",function(){update(this.value,750);});}// close data-function\n});// close useeffect\nreturn/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"select\",{id:\"selectbox\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"_1\",children:\"Instagram\"}),/*#__PURE__*/_jsx(\"option\",{value:\"_2\",children:\"Facebook\"}),/*#__PURE__*/_jsx(\"option\",{value:\"_3\",children:\"Twitter\"})]}),/*#__PURE__*/_jsx(\"svg\",{id:\"lineChart\",width:\"595\",height:\"287\",ref:d3Container})]});};export default LineChart;","map":{"version":3,"sources":["/Users/lovisaforsberg/MS_vis/ms_viz/src/components/Line_chart.js"],"names":["React","useContext","useEffect","useRef","useReducer","useState","createContext","d3","import_data","LineChart","d3Container","select","selectAll","remove","csv","then","d","chart","data","keys","columns","slice","parseTime","timeParse","formatDate","timeFormat","bisectDate","bisector","date","left","formatValue","format","forEach","svg","current","attr","margin","top","right","bottom","width","height","x","scaleTime","rangeRound","domain","extent","y","scaleLinear","z","scaleOrdinal","line","curve","curveCardinal","degrees","append","style","call","axisBottom","focus","overlay","update","property","input","speed","copy","filter","f","includes","cities","map","id","values","max","c","nice","transition","duration","axisLeft","tickSize","city","exit","enter","insert","merge","tooltip","labels","_","i","circles","on","mousemove","x0","invert","mouse","d0","d1","moth","text","e","selectbox","value"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useRef, useReducer, useState, createContext } from \"react\";\nimport * as d3 from 'd3'\nimport import_data from '../data/channel_sentiment.csv'\nimport './linechart.css'\n\n/*\navg value to put in csv\navg,30,4,66,27,5,68,23,9,67\n*/\n\nconst LineChart = ()=> {\n\n    const d3Container = useRef(null)\n\n    useEffect(()=>{\n    d3.select(\".root_linechart\").selectAll('*').remove()\n\n\n    d3.csv(import_data).then(d => chart(d))\n\n  function chart(data) {\n\n\tvar keys = data.columns.slice(1);\n\n\tvar parseTime = d3.timeParse(\"%Y%m%d\"),\n\t\tformatDate = d3.timeFormat(\"%Y-%m-%d\"),\n\t\tbisectDate = d3.bisector(d => d.date).left,\n\t\tformatValue = d3.format(\",.0f\");\n\n\tdata.forEach(function(d) {\n\t\td.date = parseTime(d.date);\n\t\treturn d;\n\t})\n\n\tvar svg = d3.select(d3Container.current).attr('class', 'root_linechart'),\n\t\tmargin = {top: 15, right: 35, bottom: 15, left: 35},\n\t\twidth = +svg.attr(\"width\") - margin.left - margin.right,\n\t\theight = +svg.attr(\"height\") - margin.top - margin.bottom;\n\n\tvar x = d3.scaleTime()\n\t\t.rangeRound([margin.left, width - margin.right])\n\t\t.domain(d3.extent(data, d => d.date))\n  \n\n\n\tvar y = d3.scaleLinear()\n\t\t.rangeRound([height - margin.bottom, margin.top]);\n\n\tvar z = d3.scaleOrdinal(['#63A37B','#F15645', '#7D7D7D']);\n\n\tvar line = d3.line()\n\t\t.curve(d3.curveCardinal)\n\t\t.x(d => x(d.date))\n\t\t.y(d => y(d.degrees));\n\n\tsvg.append(\"g\")\n\t\t.attr(\"class\",\"x-axis\")\n    .style('color', '#999')\n\t\t.attr(\"transform\", \"translate(0,\" + (height - margin.bottom) + \")\")\n\t\t.call(d3.axisBottom(x));\n\n\tsvg.append(\"g\")\n\t\t.attr(\"class\", \"y-axis\")\n    .style('color', '#999')\n\t\t.attr(\"transform\", \"translate(\" + margin.left + \",0)\");\n\n\tvar focus = svg.append(\"g\")\n\t\t.attr(\"class\", \"focus\")\n\t\t.style(\"display\", \"none\");\n\n\tfocus.append(\"line\").attr(\"class\", \"lineHover\")\n\t\t.style(\"stroke\", \"#999\")\n\t\t.attr(\"stroke-width\", 1)\n\t\t.style(\"shape-rendering\", \"crispEdges\")\n\t\t.style(\"opacity\", 0.5)\n\t\t.attr(\"y1\", -height)\n\t\t.attr(\"y2\",0);\n\n\tfocus.append(\"text\").attr(\"class\", \"lineHoverDate\")\n\t\t.attr(\"text-anchor\", \"middle\")\n\t\t.attr(\"font-size\", 12);\n\n\tvar overlay = svg.append(\"rect\")\n\t\t.attr(\"class\", \"overlay\")\n\t\t.attr(\"x\", margin.left)\n\t\t.attr(\"width\", width - margin.right - margin.left)\n\t\t.attr(\"height\", height)\n\n\tupdate(d3.select('#selectbox').property('value'), 0);\n\n\tfunction update(input, speed) {\n\n\t\tvar copy = keys.filter(f => f.includes(input))\n\n\t\tvar cities = copy.map(function(id) {\n\t\t\treturn {\n\t\t\t\tid: id,\n\t\t\t\tvalues: data.map(d => {return {date: d.date, degrees: +d[id]}})\n\t\t\t};\n\t\t});\n\n\t\ty.domain([\n\t\t\t//d3.min(cities, d => d3.min(d.values, c => c.degrees)),\n\t\t\t-5,\n\t\t\td3.max(cities, d => d3.max(d.values, c => c.degrees))\n\t\t]).nice();\n\n\t\tsvg.selectAll(\".y-axis\").transition()\n\t\t\t.duration(speed)\n\t\t\t.call(d3.axisLeft(y).tickSize(-width + margin.right + margin.left))\n\n\t\tvar city = svg.selectAll(\".cities\")\n\t\t\t.data(cities);\n\n\t\tcity.exit().remove();\n\n\t\tcity.enter().insert(\"g\", \".focus\").append(\"path\")\n\t\t\t.attr(\"class\", \"line cities\")\n\t\t\t.style(\"stroke\", d => z(d.id))\n\t\t\t.merge(city)\n\t\t.transition().duration(speed)\n\t\t\t.attr(\"d\", d => line(d.values))\n\n\t\ttooltip(copy);\n\t}\n\n\tfunction tooltip(copy) {\n\t\t\n\t\tvar labels = focus.selectAll(\".lineHoverText\")\n\t\t\t.data(copy)\n\n\t\tlabels.enter().append(\"text\")\n\t\t\t.attr(\"class\", \"lineHoverText\")\n\t\t\t.style(\"fill\", d => z(d))\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.attr(\"font-size\",12)\n\t\t\t.attr(\"dy\", (_, i) => 1 + i * 2 + \"em\")\n\t\t\t.merge(labels);\n\n\t\tvar circles = focus.selectAll(\".hoverCircle\")\n\t\t\t.data(copy)\n\n\t\tcircles.enter().append(\"circle\")\n\t\t\t.attr(\"class\", \"hoverCircle\")\n\t\t\t.style(\"fill\", d => z(d))\n\t\t\t.attr(\"r\", 2.5)\n\t\t\t.merge(circles);\n\n\t\tsvg.selectAll(\".overlay\")\n\t\t\t.on(\"mouseover\", function() { focus.style(\"display\", null); })\n\t\t\t.on(\"mouseout\", function() { focus.style(\"display\", \"none\"); })\n\t\t\t.on(\"mousemove\", mousemove);\n\n\t\tfunction mousemove() {\n\n\t\t\tvar x0 = x.invert(d3.mouse(this)[0]),\n\t\t\t\ti = bisectDate(data, x0, 1),\n\t\t\t\td0 = data[i - 1],\n\t\t\t\td1 = data[i],\n\t\t\t\td = x0 - d0.date > d1.date - x0 ? d1 : d0;\n\n\t\t\tfocus.select(\".lineHover\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + x(d.date) + \",\" + height + \")\");\n\n\t\t\tfocus.select(\".lineHoverDate\")\n\t\t\t\t.attr(\"transform\", \n\t\t\t\t\t\"translate(\" + x(d.moth) + \",\" + (height + margin.bottom) + \")\")\n\t\t\t\t.text(formatDate(d.date));\n\n\t\t\tfocus.selectAll(\".hoverCircle\")\n\t\t\t\t.attr(\"cy\", e => y(d[e]))\n\t\t\t\t.attr(\"cx\", x(d.date));\n\n\t\t\tfocus.selectAll(\".lineHoverText\")\n\t\t\t\t.attr(\"transform\", \n\t\t\t\t\t\"translate(\" + (x(d.date)) + \",\" + height / 2.5 + \")\")\n\t\t\t\t//.text(e => e + \" \"  + formatValue(d[e])+' %');\n        .text(function(e){if (e.slice(0,3) === 'pos'){\n          return 'Positive: ' + formatValue(d[e])+ ' %'\n          }\n          else if (e.slice(0,3) === 'neg'){\n            return 'Negative: ' + formatValue(d[e])+ ' %'\n          }\n          else if ( e.slice(0,3) === 'neu'){\n            return 'Neatural: ' + formatValue(d[e])+ ' %'\n          }\n      });\n\n\t\t\tx(d.date) > (width - width / 4) \n\t\t\t\t? focus.selectAll(\"text.lineHoverText\")\n\t\t\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t\t\t.attr(\"dx\", -10)\n\t\t\t\t: focus.selectAll(\"text.lineHoverText\")\n\t\t\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t\t\t.attr(\"dx\", 10)\n\t\t}\n\t}\n\n\tvar selectbox = d3.select(\"#selectbox\")\n\t\t.on(\"change\", function() {\n\t\t\tupdate(this.value, 750);\n\t\t})\n} // close data-function\n\n    }) // close useeffect\n\n    return(\n      <>\n\t  \n      <select id=\"selectbox\">\n\t      <option value=\"_1\">Instagram</option>\n      \t<option value=\"_2\">Facebook</option>\n        <option value=\"_3\">Twitter</option>\n\n      </select>\n        <svg id='lineChart' width=\"595\" height=\"287\" ref={d3Container}></svg>\n        </>\n    )\n}\n\nexport default LineChart; \n"]},"metadata":{},"sourceType":"module"}