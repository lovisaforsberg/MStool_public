{"ast":null,"code":"import _slicedToArray from\"/Users/lovisaforsberg/MS_vis/ms_viz/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useEffect,useRef,useReducer,useState,createContext}from\"react\";import ReactTooltip from'react-tooltip';import*as d3 from'd3';import{SentimentContext}from'../App';import{HoverContext}from'../App';import'../style/netsentiment.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var NetSentiment=function NetSentiment(){var SentSentimentContext=useContext(SentimentContext);var choosenSentiment=SentSentimentContext.choosenSentiment,setChoosenSentiment=SentSentimentContext.setChoosenSentiment;//const [postData, setPostData] = useState([])\nvar SentHoverContext=useContext(HoverContext);var hover=SentHoverContext.hover,setHover=SentHoverContext.setHover;// weights\nvar _useState=useState(1),_useState2=_slicedToArray(_useState,2),commentWeight=_useState2[0],setCommentWeight=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),likeWeight=_useState4[0],setLikeWeight=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),shareWeight=_useState6[0],setShareWeight=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),useComment=_useState8[0],setUseComment=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),useLike=_useState10[0],setUseLike=_useState10[1];var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),useShare=_useState12[0],setUseShare=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),includeNet=_useState14[0],setIncludeNet=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),isSensitive=_useState16[0],setIsSensitive=_useState16[1];var postData=[];var handleData=function handleData(data,variable){if(!('children'in data)){if(variable=='comments'){postData.push({//value: (data.pos-data.neg)*data.comments, name:data.name\ncomment:data.comments,like:data.likes,share:data.shares,name:data.name,pos:data.pos,neg:data.neg,followers:data.followers});}if(variable=='likes'){postData.push({value:(data.pos-data.neg)*data.likes,name:data.name});}}else{data.children.forEach(function(child){handleData(child,variable);});}};var handleCommentWeight=function handleCommentWeight(event){setCommentWeight(event.target.value);};var handleLikeWeight=function handleLikeWeight(event){setLikeWeight(event.target.value);};var handleShareWeight=function handleShareWeight(event){setShareWeight(event.target.value);};handleData(choosenSentiment,'comments');var d3Container=useRef(null);useEffect(function(){d3.select(\".root_netsentiment\").selectAll('*').remove();var margin={top:30,right:10,bottom:10,left:60},width=400-margin.left-margin.right,height=200-margin.top-margin.bottom;var valueConstant=function valueConstant(d){var constant=((useComment?commentWeight*d.comment:1)+(useLike?likeWeight*d.like:1)+(useShare?shareWeight*d.share:1))*(includeNet?isSensitive?d.pos-2*d.neg:d.pos-d.neg:1);//var rate = ((constant/d.followers)*100).toFixed(2)\nreturn constant;};//var values = postData.map(function (d) {return d.value})\nvar values=postData.map(function(d){return valueConstant(d);});var keys=postData.map(function(d){return d.name;});var maxHeight=d3.max(values);var minHeight=d3.min(values);//set y scale\nvar yScale=d3.scaleLinear().rangeRound([0,height]).domain([maxHeight,-maxHeight]);//add x axis\nvar xScale=d3.scaleBand().rangeRound([0,width]).padding(0.5).domain(keys);var yAxisScale=d3.axisLeft(yScale).tickFormat(function(d){return parseInt(d);});var xAxisScale=d3.axisBottom(xScale);/*.tickFormat(\"\");remove tick label*/var divTooltip=d3.select('body').append('div').attr('class','toolTip').attr('font-size','100px');var svg=d3.select(d3Container.current).attr('class','root_netsentiment').append(\"svg\").attr(\"width\",width+margin.left+margin.right).attr(\"height\",height+margin.top+margin.bottom).append(\"g\")//add group to leave margin for axis\n.attr(\"transform\",\"translate(\"+margin.left+\",\"+margin.top+\")\");var bars=svg.selectAll(\"rect\").data(postData).enter().append(\"rect\").attr(\"x\",function(d,i){return xScale(d.name);}).attr(\"y\",function(d){if(valueConstant(d)<0){return height/2;}else{return yScale(valueConstant(d));}})//for bottom to top\n.attr(\"width\",xScale.bandwidth()/*width/dataset.length-barpadding*/).attr(\"height\",function(d){return height/2-yScale(Math.abs(valueConstant(d)));}).attr(\"fill-opacity\",function(d){return hover.length===0?1:hover.includes(d.name)?1:0.5;}).attr(\"fill\",function(d){return valueConstant(d)>0?'#63A37B':'rgb(241, 86, 69)';}).style(\"cursor\",\"pointer\").on('mousemove',function(d){divTooltip.style('left',d3.event.pageX+10+'px').style('top',d3.event.pageY-25+'px').style('display','inline-block').html('<strong>'+d.name+'</strong>'+'<br/> Score: '+valueConstant(d));}).on('mouseout',function(d){divTooltip.style('display','none');});//add x and y axis\nvar yAxis=svg.append(\"g\").attr(\"class\",\"y axis\").call(yAxisScale).append(\"text\").attr(\"transform\",\"rotate(-90)\").attr(\"y\",6).attr(\"dy\",\".71em\").style(\"text-anchor\",\"end\").style(\"fill\",\"#4d4d4d\").text(\"Net Sentiment\");svg.append(\"g\").attr(\"class\",\"x axis\").call(xAxisScale).attr(\"transform\",\"translate(0,\"+height/2+\")\").selectAll(\"text\").style(\"text-anchor\",\"end\").attr(\"dx\",\"1.2em\").attr(\"dy\",\"1em\").attr('overflow','visible').attr(\"transform\",\"rotate(-45)\").style('font-size','8px')//.style('text-decoration', 'underline')\n.attr('fill','#4d4d4d').style('cursor','pointer').on('mouseover',function(d){d3.select(this).style('font-size','12px');}).on('mouseout',function(d){d3.select(this).style('font-size','8px');});//.call(wrap, 0)\nfunction wrap(text,width){text.each(function(){var text=d3.select(this),words=text.text().split(/\\s+/).reverse(),word,line=[],lineNumber=0,lineHeight=1,// ems\ny=text.attr(\"y\")-(words.length+1)*4,dy=parseFloat(text.attr(\"dy\")),tspan=text.text(null).append(\"tspan\").attr(\"x\",0).attr(\"y\",y).attr(\"dy\",dy+\"em\");while(word=words.pop()){line.push(word);tspan.text(line.join(\" \"));if(tspan.node().getComputedTextLength()>width){line.pop();tspan.text(line.join(\" \"));line=[word];tspan=text.append(\"tspan\").attr(\"x\",0).attr(\"y\",y).attr(\"dy\",++lineNumber*lineHeight+dy+\"em\").text(word);}}});}/*\n        var margin = {top: 30, right: 10, bottom: 50, left: 50},\n        width = 150,\n        height = 150;\n\t\t\n        var data = [{value: 10, dataset:\"barbaz\"},\n        {value: 40, dataset:\"barbar\"},\n        {value: -10, dataset:\"foobaz\"},\n        {value: 50, dataset:\"foobar\"},\n        ];\n\n        // Add svg to\n        var svg = d3.select(d3Container.current)\n        .attr('class', 'root_netsentiment')\n        .append('svg')\n        .attr('width', width + margin.left + margin.right)\n        .attr('height', height + margin.top + margin.bottom)\n        .append('g')\n        .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n\n        // set the ranges\n        var y = d3.scaleBand()\n            .range([height, 0])\n            .padding(0.1);\n\n        var x = d3.scaleLinear()\n            //.range([0, width])\n            .rangeRound([margin.left, width - margin.right])\n\n        // Scale the range of the data in the domains\n        x.domain(d3.extent(post_data, function (d) {return d.value;}));\n        \n        y.domain(post_data.map(function (d) {\n            return d.name;\n        }));\n\n        var xAxis = d3.axisBottom(x)\n        .ticks(5)\n\n        var yAxis = d3.axisRight(y)\n\n        // append the rectangles for the bar chart\n        svg.selectAll(\".bar\")\n            .data(post_data)\n            .enter().append(\"rect\")\n            .attr(\"class\", function (d) {\n                return \"bar bar--\" + (d.value < 0 ? \"negative\" : \"positive\");\n            })\n            .attr(\"x\", function (d) {\n                return x(Math.min(0, d.value));\n            })\n            .attr(\"y\", function (d) {\n                return y(d.name);\n            })\n            .attr(\"width\", function (d) {\n                return Math.abs(x(d.value) - x(0));\n            })\n            .attr(\"height\", y.bandwidth());\n\n        // add the x Axis\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(xAxis)\n            .selectAll(\".x.axis text\")\n            .style(\"fill\",\"#4d4d4d\")\n\n        // add the y Axis\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .attr(\"transform\", \"translate(\" + x(0) + \",0)\")\n            .call(yAxis)\n            .selectAll(\".y.axis text\")\n            .style(\"fill\",\"#4d4d4d\")\n\n       */},[choosenSentiment,hover,useComment,useLike,useShare,commentWeight,likeWeight,shareWeight,includeNet,isSensitive]);// close useeffect\nreturn/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"NetContainer\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"graphContainer\",children:/*#__PURE__*/_jsx(\"svg\",{id:\"netSentiment\",width:400,height:300,ref:d3Container})}),/*#__PURE__*/_jsxs(\"div\",{className:\"textContainer\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"NetHeadline\",children:\"Engagement =\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"NetFormula\",children:[/*#__PURE__*/_jsxs(\"span\",{style:useComment?{opacity:1}:{opacity:0.5},children:[\"(\",commentWeight,\" x Comments)\"]}),\" +\",/*#__PURE__*/_jsxs(\"span\",{style:useLike?{opacity:1}:{opacity:0.5},children:[\" (\",likeWeight,\" x Likes)\"]}),\"  +\",/*#__PURE__*/_jsxs(\"span\",{style:useShare?{opacity:1}:{opacity:0.5},children:[\" (\",shareWeight,\" x Shares)\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"AllCheckboxContainer\",children:[/*#__PURE__*/_jsxs(\"div\",{className:useComment?'CheckboxActive':'CheckboxInactive',children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"foo\",value:\"com\",id:\"foo_com\",checked:useComment,onChange:function onChange(){return setUseComment(!useComment);}}),/*#__PURE__*/_jsx(\"label\",{className:\"checkLabel\",for:\"foo_com\",children:\"Comment\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"weightText\",children:\"Change weight: \"}),/*#__PURE__*/_jsx(\"input\",{className:\"weightInput\",type:\"number\",onChange:handleCommentWeight,value:commentWeight})]}),/*#__PURE__*/_jsxs(\"div\",{className:useLike?'CheckboxActive':'CheckboxInactive',children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"foo\",value:\"com\",id:\"foo_com\",checked:useLike,onChange:function onChange(){return setUseLike(!useLike);}}),/*#__PURE__*/_jsx(\"label\",{className:\"checkLabel\",for:\"foo_com\",children:\"Likes\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"weightText\",children:\"Change weight: \"}),/*#__PURE__*/_jsx(\"input\",{className:\"weightInput\",type:\"number\",onChange:handleLikeWeight,value:likeWeight})]}),/*#__PURE__*/_jsxs(\"div\",{className:useShare?'CheckboxActive':'CheckboxInactive',children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"foo\",value:\"com\",id:\"foo_com\",checked:useShare,onChange:function onChange(){return setUseShare(!useShare);}}),/*#__PURE__*/_jsx(\"label\",{className:\"checkLabel\",for:\"foo_com\",children:\"Shares\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"weightText\",children:\"Change weight: \"}),/*#__PURE__*/_jsx(\"input\",{className:\"weightInput\",type:\"number\",onChange:handleShareWeight,value:shareWeight})]})]}),/*#__PURE__*/_jsxs(\"button\",{id:\"cha_button\",className:includeNet?'netButtonActive':'netButtonInactive',onClick:function onClick(){return setIncludeNet(!includeNet);},children:[includeNet?'Remove Net Sentiment':'Include Net Sentiment',\" \"]}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-info-circle bar_info\",\"data-tip\":true,\"data-for\":\"NetSentInfo\"}),/*#__PURE__*/_jsxs(ReactTooltip,{id:\"NetSentInfo\",className:\"bar_infoTooltip\",place:\"top\",textColor:\"#4d4d4d\",backgroundColor:\"#FFDFC3\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"By including Net Sentiment, the engagement score will be multiplied with:\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"(Amount of \",/*#__PURE__*/_jsx(\"strong\",{children:\"positive sentiment\"}),\") - (Amount of \",/*#__PURE__*/_jsx(\"strong\",{children:\"negative sentiment\"})]})]}),includeNet?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"NetFormula\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Engagement *\"}),\"(\",/*#__PURE__*/_jsx(\"span\",{children:\" 1x Positive\"}),\"  -\",/*#__PURE__*/_jsxs(\"span\",{children:[isSensitive?'2':'1',\"x Negative\"]}),\")\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"markBtnContainer\",children:[/*#__PURE__*/_jsx(\"button\",{id:\"cha_button\",className:isSensitive?'netButtonActiveRed':'netButtonInactive',onClick:function onClick(){return setIsSensitive(!isSensitive);},children:isSensitive?'Unmark as sensitive':'Mark as sensitive'}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-info-circle bar_info\",\"data-tip\":true,\"data-for\":\"sensitiveInfo\"}),/*#__PURE__*/_jsxs(ReactTooltip,{id:\"sensitiveInfo\",className:\"bar_infoTooltip\",place:\"top\",textColor:\"#4d4d4d\",backgroundColor:\"#FFDFC3\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"If the subject of the category or post is sensitive, the negative comments can cause more harm.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"By marking the post/category as sensitive, net sentiment will be calculated as (positive - 2x negative)\"})]})]})]}):null]})]})});};export default NetSentiment;","map":{"version":3,"sources":["/Users/lovisaforsberg/MS_vis/ms_viz/src/components/netsentiment.js"],"names":["React","useContext","useEffect","useRef","useReducer","useState","createContext","ReactTooltip","d3","SentimentContext","HoverContext","NetSentiment","SentSentimentContext","choosenSentiment","setChoosenSentiment","SentHoverContext","hover","setHover","commentWeight","setCommentWeight","likeWeight","setLikeWeight","shareWeight","setShareWeight","useComment","setUseComment","useLike","setUseLike","useShare","setUseShare","includeNet","setIncludeNet","isSensitive","setIsSensitive","postData","handleData","data","variable","push","comment","comments","like","likes","share","shares","name","pos","neg","followers","value","children","forEach","child","handleCommentWeight","event","target","handleLikeWeight","handleShareWeight","d3Container","select","selectAll","remove","margin","top","right","bottom","left","width","height","valueConstant","d","constant","values","map","keys","maxHeight","max","minHeight","min","yScale","scaleLinear","rangeRound","domain","xScale","scaleBand","padding","yAxisScale","axisLeft","tickFormat","parseInt","xAxisScale","axisBottom","divTooltip","append","attr","svg","current","bars","enter","i","bandwidth","Math","abs","length","includes","style","on","pageX","pageY","html","yAxis","call","text","wrap","each","words","split","reverse","word","line","lineNumber","lineHeight","y","dy","parseFloat","tspan","pop","join","node","getComputedTextLength","opacity"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useRef, useReducer, useState, createContext } from \"react\";\nimport ReactTooltip from 'react-tooltip';\nimport * as d3 from 'd3'\nimport {SentimentContext} from '../App'\nimport {HoverContext} from '../App'\nimport '../style/netsentiment.css'\n\n\nconst NetSentiment = () =>{\n\n    const SentSentimentContext = useContext(SentimentContext);\n    const {choosenSentiment, setChoosenSentiment} = SentSentimentContext\n    //const [postData, setPostData] = useState([])\n\n    const SentHoverContext = useContext(HoverContext);\n    const {hover, setHover} = SentHoverContext\n\n    // weights\n    const [commentWeight, setCommentWeight] = useState(1)\n    const [likeWeight, setLikeWeight] = useState(1)\n    const [shareWeight, setShareWeight] = useState(1)\n\n    const [useComment, setUseComment] = useState(true)\n    const [useLike, setUseLike] = useState(true)\n    const [useShare, setUseShare] = useState(true)\n\n    const [includeNet, setIncludeNet] = useState(false)\n\n    const [isSensitive, setIsSensitive] = useState(false)\n\n\n    var postData = []\n    const handleData = (data, variable) =>{\n       \n        if (!('children' in data)){\n            if (variable == 'comments'){\n                postData.push({\n                    //value: (data.pos-data.neg)*data.comments, name:data.name\n                    comment:data.comments, \n                    like: data.likes, \n                    share: data.shares, \n                    name: data.name,\n                    pos:data.pos,\n                    neg:data.neg,\n                    followers: data.followers\n                })\n            }\n            if (variable == 'likes'){\n                postData.push({\n                    value: (data.pos-data.neg)*data.likes, name:data.name\n                })\n            }\n        }\n        else{\n            data.children.forEach(child =>{\n                handleData(child, variable)\n            })\n        }\n    }\n\n\n    const handleCommentWeight = event => {\n        setCommentWeight(event.target.value);\n      };\n    const handleLikeWeight = event => {\n        setLikeWeight(event.target.value);\n      };\n    const handleShareWeight = event => {\n        setShareWeight(event.target.value);\n      };\n\n\n    handleData(choosenSentiment, 'comments')\n\n\n    const d3Container = useRef(null)\n\n    useEffect(()=>{\n\n        d3.select(\".root_netsentiment\").selectAll('*').remove()\n\n        var margin = {top: 30, right: 10, bottom: 10, left: 60},\n        width = 400 - margin.left - margin.right,\n        height = 200 - margin.top - margin.bottom;\n\n        const valueConstant = (d) =>{\n            var constant = (((useComment?commentWeight*d.comment:1)\n            +(useLike?likeWeight*d.like:1)\n            +(useShare?shareWeight*d.share:1))\n            *(includeNet?(isSensitive?(d.pos-2*d.neg):(d.pos-d.neg)):1))\n\n            //var rate = ((constant/d.followers)*100).toFixed(2)\n\n            return constant\n        } \n\n        //var values = postData.map(function (d) {return d.value})\n        var values = postData.map(function (d) {return valueConstant(d)\n                                                })\n\n        var keys = postData.map(function (d) {return d.name})\n        \n        var maxHeight=d3.max(values);\n        var minHeight=d3.min(values)  \n\n        \n        \n\n    \n    //set y scale\n\tvar yScale = d3.scaleLinear()\n    .rangeRound([0,height])\n    .domain([maxHeight,-maxHeight])\n\t\n    //add x axis\n\tvar xScale = d3.scaleBand()\n    .rangeRound([0,width])\n    .padding(0.5)\n\t.domain(keys)\n\n    var yAxisScale = d3.axisLeft(yScale)\n    .tickFormat(function(d) { return parseInt(d) });\n\n    \n    var xAxisScale = d3.axisBottom(xScale);/*.tickFormat(\"\");remove tick label*/\n\n    var divTooltip = d3\n        .select('body')\n        .append('div')\n        .attr('class', 'toolTip')\n        .attr('font-size', '100px')\n\t\n\n    var svg = d3.select(d3Container.current)\n                .attr('class', 'root_netsentiment')\n                .append(\"svg\")\n\t\t\t\t.attr(\"width\",width+margin.left+margin.right)\n\t\t\t\t.attr(\"height\",height+margin.top+margin.bottom)\n\t\t\t\t.append(\"g\")  //add group to leave margin for axis\n\t\t\t\t.attr(\"transform\",\"translate(\"+margin.left+\",\"+margin.top+\")\");\n\n    var bars = svg.selectAll(\"rect\")\n                .data(postData)\n                .enter()\n                .append(\"rect\")\n                .attr(\"x\",function(d,i){return xScale(d.name);})\n                .attr(\"y\",function(d){if(valueConstant(d)<0){return height/2;}\n\n                                else{return yScale(\n                                    valueConstant(d)\n                                    );}})//for bottom to top\n                \n                .attr(\"width\", xScale.bandwidth()/*width/dataset.length-barpadding*/)\n                .attr(\"height\", function(d){return height/2 -yScale(Math.abs(\n                    valueConstant(d)\n                    ));})\n\n                .attr(\"fill-opacity\", \n                    (d)=> hover.length === 0 ? 1 : hover.includes(d.name) ? 1 : 0.5\n                )\n                \n                .attr(\"fill\",function(d){return valueConstant(d) > 0 ? '#63A37B' : 'rgb(241, 86, 69)'})\n                .style(\"cursor\", \"pointer\")\n                .on('mousemove', function(d){\n                    divTooltip\n                    .style('left', d3.event.pageX+10+'px')\n                    .style('top', d3.event.pageY-25+'px')\n                    .style('display', 'inline-block')\n                    .html('<strong>'+d.name+'</strong>'+'<br/> Score: '+\n                    valueConstant(d)\n                    )\n                })\n                .on('mouseout', function(d){\n                    divTooltip.style('display', 'none')\n                })\n                        \n\t\n\t//add x and y axis\n\tvar yAxis = svg.append(\"g\")\n        .attr(\"class\", \"y axis\")\n        .call(yAxisScale)\n        .append(\"text\")\n        .attr(\"transform\", \"rotate(-90)\")\n        .attr(\"y\", 6)\n        .attr(\"dy\", \".71em\")\n        .style(\"text-anchor\", \"end\")\n        .style(\"fill\", \"#4d4d4d\")\n        .text(\"Net Sentiment\")\n    \n\n\t\n\tsvg.append(\"g\")\n        .attr(\"class\", \"x axis\")\n        .call(xAxisScale)\n        .attr(\"transform\", \"translate(0,\"+height/2+\")\")\n        .selectAll(\"text\")\n        .style(\"text-anchor\", \"end\")\n        .attr(\"dx\", \"1.2em\")\n        .attr(\"dy\", \"1em\")\n        .attr('overflow', 'visible')\n        .attr(\"transform\", \"rotate(-45)\")\n        .style('font-size', '8px')\n        //.style('text-decoration', 'underline')\n        .attr('fill', '#4d4d4d')\n        .style('cursor', 'pointer')\n        .on('mouseover', function(d){d3.select(this).style('font-size', '12px')})\n        .on('mouseout', function(d){d3.select(this).style('font-size', '8px')})\n\n        //.call(wrap, 0)\n        \n    \n\t\n\n\n        function wrap(text, width) {\n            text.each(function () {\n                var text = d3.select(this),\n                    words = text.text().split(/\\s+/).reverse(),\n                    word,\n                    line = [],\n                    lineNumber = 0,\n                    lineHeight = 1, // ems\n                    y = text.attr(\"y\")-((words.length+1)*4),\n                    dy = parseFloat(text.attr(\"dy\")),\n                    tspan = text.text(null).append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", dy + \"em\");\n                while (word = words.pop()) {\n                    line.push(word);\n                    tspan.text(line.join(\" \"));\n                    if (tspan.node().getComputedTextLength() > width) {\n                        line.pop();\n                        tspan.text(line.join(\" \"));\n                        line = [word];\n                        tspan = text.append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", ++lineNumber * lineHeight + dy + \"em\").text(word);\n                    }\n                }\n            });\n          }\n     \n\n\n\n\n        /*\n        var margin = {top: 30, right: 10, bottom: 50, left: 50},\n        width = 150,\n        height = 150;\n\t\t\n        var data = [{value: 10, dataset:\"barbaz\"},\n        {value: 40, dataset:\"barbar\"},\n        {value: -10, dataset:\"foobaz\"},\n        {value: 50, dataset:\"foobar\"},\n        ];\n\n        // Add svg to\n        var svg = d3.select(d3Container.current)\n        .attr('class', 'root_netsentiment')\n        .append('svg')\n        .attr('width', width + margin.left + margin.right)\n        .attr('height', height + margin.top + margin.bottom)\n        .append('g')\n        .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n\n        // set the ranges\n        var y = d3.scaleBand()\n            .range([height, 0])\n            .padding(0.1);\n\n        var x = d3.scaleLinear()\n            //.range([0, width])\n            .rangeRound([margin.left, width - margin.right])\n\n        // Scale the range of the data in the domains\n        x.domain(d3.extent(post_data, function (d) {return d.value;}));\n        \n        y.domain(post_data.map(function (d) {\n            return d.name;\n        }));\n\n        var xAxis = d3.axisBottom(x)\n        .ticks(5)\n\n        var yAxis = d3.axisRight(y)\n\n        // append the rectangles for the bar chart\n        svg.selectAll(\".bar\")\n            .data(post_data)\n            .enter().append(\"rect\")\n            .attr(\"class\", function (d) {\n                return \"bar bar--\" + (d.value < 0 ? \"negative\" : \"positive\");\n            })\n            .attr(\"x\", function (d) {\n                return x(Math.min(0, d.value));\n            })\n            .attr(\"y\", function (d) {\n                return y(d.name);\n            })\n            .attr(\"width\", function (d) {\n                return Math.abs(x(d.value) - x(0));\n            })\n            .attr(\"height\", y.bandwidth());\n\n        // add the x Axis\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(xAxis)\n            .selectAll(\".x.axis text\")\n            .style(\"fill\",\"#4d4d4d\")\n\n        // add the y Axis\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .attr(\"transform\", \"translate(\" + x(0) + \",0)\")\n            .call(yAxis)\n            .selectAll(\".y.axis text\")\n            .style(\"fill\",\"#4d4d4d\")\n\n       */ \n\n    }, [choosenSentiment, \n        hover, \n        useComment, \n        useLike, \n        useShare, \n        commentWeight,\n        likeWeight,\n        shareWeight,\n        includeNet,\n        isSensitive]) // close useeffect\n\n    return(\n        <>\n        {/*\n        <div className='btnContainer'>\n          <button id='cha_button' className='groupButtonActive' onClick={()=>handleChangeData(choosenSentiment,'comments')}>Comments</button>\n          <button id='cat_button' className='groupButtonInactive' onClick={()=>handleChangeData(choosenSentiment,'likes')}>Likes</button>\n        </div>\n        */}\n            <div className='NetContainer'>\n                <div className=\"graphContainer\">\n                    <svg id='netSentiment' width={400} height={300} ref={d3Container}></svg> \n                </div>\n\n                <div className='textContainer'>\n                    <div className='NetHeadline'>Engagement =</div>\n                    <div className='NetFormula'>\n                                        <span style={useComment?{opacity:1}:{opacity:0.5}}>({commentWeight} x Comments)</span> +\n                                        <span style={useLike?{opacity:1}:{opacity:0.5}}> ({likeWeight} x Likes)</span>  +\n                                        <span style={useShare?{opacity:1}:{opacity:0.5}}> ({shareWeight} x Shares)</span>\n                    </div>\n\n                    <div className=\"AllCheckboxContainer\">\n                        <div className={useComment?'CheckboxActive':'CheckboxInactive'}>\n                            <div>\n                                <input type=\"checkbox\" \n                                        name=\"foo\" \n                                        value=\"com\" \n                                        id=\"foo_com\"\n                                        checked={useComment}\n                                        onChange={()=>setUseComment(!(useComment))}/>\n                                <label className='checkLabel' for=\"foo_com\">Comment</label>\n                            </div>\n\n                            \n                            <div className='weightText'>Change weight: </div>\n                            {/*<button className='weightBtn'>-</button>*/}\n                            <input className='weightInput' \n                                    type=\"number\" \n                                    onChange={handleCommentWeight}\n                                    value={commentWeight}\n                                    />\n                        \n                        </div>\n\n                        <div className={useLike?'CheckboxActive':'CheckboxInactive'}>\n                            <div>\n                                <input type=\"checkbox\" \n                                        name=\"foo\" \n                                        value=\"com\" \n                                        id=\"foo_com\"\n                                        checked={useLike}\n                                        onChange={()=>setUseLike(!(useLike))}/>\n                                <label className='checkLabel' for=\"foo_com\">Likes</label>\n                            </div>\n\n                            \n                            <div className='weightText'>Change weight: </div>\n                            {/*<button className='weightBtn'>-</button>*/}\n                            <input className='weightInput' \n                                    type=\"number\" \n                                    onChange={handleLikeWeight}\n                                    value={likeWeight}\n                                    />\n                        \n                        </div>\n\n                        <div className={useShare?'CheckboxActive':'CheckboxInactive'}>\n                            <div>\n                                <input type=\"checkbox\" \n                                        name=\"foo\" \n                                        value=\"com\" \n                                        id=\"foo_com\"\n                                        checked={useShare}\n                                        onChange={()=>setUseShare(!(useShare))}/>\n                                <label className='checkLabel' for=\"foo_com\">Shares</label>\n                            </div>\n\n                            \n                            <div className='weightText'>Change weight: </div>\n                            {/*<button className='weightBtn'>-</button>*/}\n                            <input className='weightInput' \n                                    type=\"number\" \n                                    onChange={handleShareWeight}\n                                    value={shareWeight}\n                                    />\n                        \n                        </div>\n\n                    </div>\n\n                    <button id='cha_button' className={includeNet?'netButtonActive':'netButtonInactive'} onClick={()=>setIncludeNet(!includeNet)}>{includeNet?'Remove Net Sentiment': 'Include Net Sentiment'} </button>\n                    <i className=\"fas fa-info-circle bar_info\" data-tip data-for='NetSentInfo'></i>\n                        <ReactTooltip id='NetSentInfo' className=\"bar_infoTooltip\" place=\"top\" textColor='#4d4d4d' backgroundColor='#FFDFC3'>\n             \n                            <p>By including Net Sentiment, the engagement score will be multiplied with:</p>\n                            <p>(Amount of <strong>positive sentiment</strong>) - (Amount of <strong>negative sentiment</strong></p>\n\n                        </ReactTooltip>\n                    {includeNet?\n                    <>\n                        <div className='NetFormula'>\n                            <span>Engagement *</span>(\n                            <span> 1x Positive</span>  -\n                            <span>{isSensitive?'2':'1'}x Negative</span>)\n                        </div>\n                        \n                        <div className='markBtnContainer'>\n                            <button id='cha_button' className={isSensitive?'netButtonActiveRed':'netButtonInactive'} onClick={()=>setIsSensitive(!isSensitive)}>{isSensitive?'Unmark as sensitive': 'Mark as sensitive'}</button>\n                            <i className=\"fas fa-info-circle bar_info\" data-tip data-for='sensitiveInfo'></i>\n                            <ReactTooltip id='sensitiveInfo' className=\"bar_infoTooltip\" place=\"top\" textColor='#4d4d4d' backgroundColor='#FFDFC3'>\n                \n                                <p>If the subject of the category or post is sensitive, the negative comments can cause more harm.</p>\n                                <p>By marking the post/category as sensitive, net sentiment will be calculated as (positive - 2x negative)</p>\n\n\n                            </ReactTooltip>\n                        </div>\n\n                    </>\n                    :null}\n\n                    \n\n\n\n                </div>\n            </div>\n           \n\n        </>\n    )\n}\n\nexport default NetSentiment"]},"metadata":{},"sourceType":"module"}